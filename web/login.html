<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="Bootstrap static html page for campaign administration."
	name="description">
<meta
	content="RTB,OpenRTB,JAVA,Advertising,real-time,campaign,administration"
	name="keywords">
<meta content="RTB4FREE" name="author">
<title><!--#include virtual="SSI/brand_name.ssi" --> Campaigns</title>
<!--#include virtual="SSI/brand_icon.ssi" -->
<link
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css"
	rel="stylesheet">
<link href="css/bootstrap-dialog.css" rel="stylesheet">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js">
</script>
 <script type="text/javascript" src="js/jquery.sparkline.js"></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>

<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js">
	
</script>
<script src="js/bootstrap-dialog.js">
	
</script>
<script src="js/rtb4free.js" rtb4free_demo=false>
	
</script>
<script src="js/vkbeautify.0.99.00.beta.js">
	
</script>

<script type="text/javascript">
$(document).ready(function() {
  $(".basic-single").select2({tags: true, width: '250px'});
});
</script>

<style type="text/css">
.bs-example {
	margin: 20px;
}

.form-signin {
	max-width: 330px;
	padding: 15px;
	margin: 0 auto;
}

.form-signin .form-signin-heading, .form-signin .checkbox {
	margin-bottom: 10px;
}

.form-signin .checkbox {
	font-weight: normal;
}

.form-signin .form-control {
	position: relative;
	font-size: 16px;
	height: auto;
	padding: 10px;
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.form-signin .form-control:focus {
	z-index: 2;
}

.form-signin input[type="text"] {
	margin-bottom: -1px;
	border-bottom-left-radius: 0;
	border-bottom-right-radius: 0;
}

.form-signin input[type="password"] {
	margin-bottom: 10px;
	border-top-left-radius: 0;
	border-top-right-radius: 0;
}

.account-wall {
	margin-top: 20px;
	padding: 40px 0px 20px 0px;
	background-color: #f7f7f7;
	-moz-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
	-webkit-box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
	box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
}

.login-title {
	color: #555;
	font-size: 18px;
	font-weight: 400;
	display: block;
}

.profile-img {
	width: 96px;
	height: 96px;
	margin: 0 auto 10px;
	display: block;
	-moz-border-radius: 50%;
	-webkit-border-radius: 50%;
	border-radius: 50%;
}

.need-help {
	margin-top: 10px;
}

.new-account {
	display: block;
	margin-top: 10px;
}
</style>
</head>
<body>
	<div class="container">
		<div class="row" id="login">
			<div class="col-sm-6 col-md-4 col-md-offset-4">
				<h1 class="text-center login-title">
					Sign in to continue to
					<!--#include virtual="SSI/brand_name.ssi" -->
					Campaign Administration Portal
				</h1>
				<div>
					<form class="form">
						<input autofocus="" class="form-control" id="username"
							placeholder="Email" required="" type="text" value=''> <input
							class="form-control" id="password" placeholder="Password"
							required="" type="password" value=''> <input
							class="btn btn-primary btnSeccion" onclick="doFormLogin();"
							type="button" value="Sign In">
					</form>
				</div>
				<script type="text/javascript">
					function toggle(elementId) {
						var ele = document.getElementById(elementId);
						if (ele.style.display == "block") {
							ele.style.display = "none";
						} else {
							ele.style.display = "block";
						}
					}
				</script>
				<script>
					(function(i, s, o, g, r, a, m) {
						i['GoogleAnalyticsObject'] = r;
						i[r] = i[r] || function() {
							(i[r].q = i[r].q || []).push(arguments)
						}, i[r].l = 1 * new Date();
						a = s.createElement(o),
								m = s.getElementsByTagName(o)[0];
						a.async = 1;
						a.src = g;
						m.parentNode.insertBefore(a, m)
					})(window, document, 'script',
							'//www.google-analytics.com/analytics.js', 'ga');
					ga('create', 'UA-5532985-4', 'auto');
					ga('send', 'pageview');
				</script>
				<div onclick="javascript:toggle('createAccount');">
					<div id="createAccount"
						style="display: none; border-width: 2px; border-style: solid">
						<p>Please send a request to Ben.Faul@gmail.com to receive a
							password to login to the system. If you want a different email
							address used for the username please indicate that on your email
							to us. We will respond with your password in a follow up email to
							the user email address you supply. Thanks, RTB4FREE.org</p>
					</div>
				</div>
			</div>
		</div>
		<div class="bs-example" id="bs-example" style="display: none">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<h3 class="panel-title">
						<!--#include virtual="SSI/brand_name.ssi" -->
						Campaign Administration for '<span id="selected">User Name
							will be here</span>' 
							<a href="http://rtb4free.com/campaigns-mgmt.html"  target="_blank" class="btn btn-warning btn-sm"><i class="icon-white icon-heart"></i>Help</a>
							<a class="btn btn-warning btn-large"
							href="javascript:saveChanges()"><i
							class="icon-white icon-heart"></i>Write DB</a> <a
							class="btn btn-danger btn-large" href="login.html"><i
							class="icon-white icon-heart"></i>Logout</a>
					</h3>
				</div>
				<div class="panel-body">


					<table id="addusers">
						<tr>
							<th>Password</th>
							<th>Phone</th>
							<th>E-Mail</th>
							<th>Credit Card</th>
						<tr id="row0">

							<td><input id="p_user_pass" name="p_new"
								placeholder="Password" size="20" type="text" value=""></td>

							<td><input id="p_user_phone" name="p_new"
								placeholder="Phone" size="20" type="text" value=""></td>

							<td><input id="p_user_email" name="p_new"
								placeholder="Email" size="20" type="text" value=""></td>

							<td><input id="p_user_credit" name="p_new"
								placeholder="Credit Authorization" size="20" type="text"
								value=""></td>
							<td><a href="javascript:updateUser();">Update</a></td>
						</tr>
					</table>


					<div id="list-block">
						<hr>
						<table>
							<tr>
								<th>Add a New Campaign:</th>
							</tr>
							<tr>
								<td><input id="ad_domain" placeholder="ad id" size="40"
									type="text" value=""></td>
								<td><input
									data-original-title="This will create a new basic campaign for you to work with."
									data-placement="bottom" data-toggle="tooltip"
									id='addCampaignButton' onclick="doDyno();" type='button'
									value='+'></td>
							</tr>
						</table>
						<br> <br>
					</div>
				</div>
				<div class="panel panel-info">
					<div class="panel-heading">
						<h3 class="panel-title">
							Edit Current Campaigns <a class="btn btn-success btn-large"
								href="#" id='saveChanges' onclick="saveChanges(); return false;"><i
								class="icon-white icon-heart"></i>Save Changes</a> <a
								class="btn btn-success btn-large" href="#" id='showCampaign'
								onclick="showCampaign(); return false;"><i
								class="icon-white icon-heart"></i>Show JSON</a> <a
								class="btn btn-info btn-large" href="#"
								onclick="doFormLogin(); return false;"><i
								class="icon-white icon-heart"></i>Revert</a>
						</h3>
					</div>
					<div class="panel-body">
						<table id="addinput">
							<tr>
								<th>Owner</th>
								<th>Select Campaign to Edit</th>
							</tr>
							<tr id="row0">
								<td></td>
								<td></td>
							</tr>
						</table>
					</div>
				</div>
			</div>
			<div id="selection">Selected: None</div>
			<ul class="nav nav-tabs" id="myTab">
				<li><a data-toggle="tab" href="#images">Images</a></li>
				<li><a data-toggle="tab" href="#attributes">Attributes</a></li>
				<li class='active'><a data-toggle="tab" href="#do_creatives">Creatives</a>
				</li>
				<li><a data-toggle="tab" href="#constraints">Constraints</a></li>
				<li><a data-toggle="tab" href="#zstatus">Status</a></li>
			</ul>
			<div class="tab-content" id="myTabContent">
				<div class="tab-pane fade" id="images">
					<div class="panel panel-success">
						<div class="panel-heading">
							<h3 class="panel-title">Upload New Images (across all
								campaigns)</h3>
						</div>
						<div class="panel-body">
							<form id="fileinfo" method="post" name="fileinfo"
								onsubmit="return submitForm();">
								<label>Select a file:</label><br> <input id="file"
									required="" type="file"> <input id="file-name"
									name="file-name" placeholder="New file name..." type="text">
								<input id='uploadFile' type="submit" value="Upload">
								<hr>
							</form>
						</div>
					</div>
					<div class="panel panel-success">
						<div class="panel-heading">
							<h3 class="panel-title">Manage Current Images (across all
								campaigns)</h3>
						</div>
						<div class="panel-body">
							<table id="addimages" rules='all'>
								<tr>
									<th>Image</th>
									<th>Filename</th>
								</tr>
								<tr id="row0">
									<td></td>
								</tr>
							</table>
						</div>
					</div>
				</div>
				<div class="tab-pane fade" id="attributes">
					<form action="#" method="get">
						<div class="form-group">
							<div class="col-lg-2">
								<label for="name">Ad Domain</label> <input class="form-control"
									id="adomain" placeholder="Enter ad domain" type="text">
							</div>
						</div>
						<div class="form-group">
							<div class="col-lg-2">
								<label for="adid">Ad Id</label> <input class="form-control"
									readonly id="adid" placeholder="Ad ID" type="text">
							</div>
						</div>
						<div class="form-group">
							<div class="col-lg-2">
								<label for="startdate">Start Date</label> <input
									class="form-control" id="startdate" placeholder="Start date"
									type="text">
							</div>
						</div>
						<div class="form-group">
							<div class="col-lg-2">
								<label for="enddate">End Date</label> <input
									class="form-control" id="enddate" placeholder="End date"
									type="text">
							</div>
						</div>

					</form>
				</div>
				<div class="tab-pane fade in active" id="do_creatives">
					<h3>
						<b><i>Is ADX</i></b> <select id='is-adx' class="selectpicker">
							<option>Yes</option>
							<option selected>No</option>
						</select>
					</h3>
					<h3>
						<b><i>Forensiq</i></b>
					</h3>
					<table>
						<tr>
							<td>Apply Forensiqs:</td>
							<td><select class="selectpicker" id='forensiqs'>
									<option>true</option>
									<option selected>false</option>
							</select></td>
						</tr>
					</table>

					<h3>
						<b><i>Native Content</i></b><i></i>
					</h3>
					<table id="addnative">
						<tr>
							<th></th>
							<th>Imp ID</th>
							<th>Type</th>
							<th>Asset Editor</th>
						</tr>
						<tr id="row0">
							<td></td>
							<td><input id="p_new_impid_native" name="p_new"
								placeholder="Impression ID" size="20" type="text" value=""></td>
							<td><select class='form-control' id="p_new_native_type">
									<option>Content Wall</option>
									<option selected>App Wall</option>
									<option>News Feed</option>
									<option>Chat List</option>
									<option>Carousel</option>
									<option>Content Stream</option>
									<option>Grid Adjoining</option>
							</select></td>
							<td></td>
							<td><a href="javascript:doDynoNative();">Add</a></td>
						</tr>
					</table>
					<hr>
					<h3>
						<b><i>Banner Content</i></b><i></i>
					</h3>
					<table id="addcreative">
						<tr>
							<th></th>
							<th>Imp ID</th>
							<th>O.T.</th>
							<th>W</th>
							<th>H</th>
							<th>Editor</th>
						</tr>
						<tr id="row0">
							<td></td>

							<td><input id="p_new_impid" name="p_new"
								placeholder="Impression ID" size="20" type="text" value=""></td>

							<td><input type='checkbox' id='p_new_ot'></td>

							<td><input id="p_new_w" name="p_new" placeholder="width"
								size="6" type="text" value=""></td>
							<td><input id="p_new_h" name="p_new" placeholder="height"
								size="6" type="text" value=""></td>
							<td></td>
							<td><a href="javascript:doDynoCreative();">Add</a></td>
						</tr>
					</table>
					<div id='show-banner'></div>
					<p></p>
					<h3>
						<b><i>Video</i></b><i></i>
					</h3>
					<table id="addvideocreative">
						<tr>
							<th></th>
							<th>Imp ID</th>
							<th>W</th>
							<th>H</th>
							<th>Tag Editor</th>
						</tr>
						<tr id="row0">
							<td></td>
							<td><input id="v_new_impid" name="p_new"
								placeholder="Impression ID" size="20" type="text" value=""></td>
							<td><input id="v_new_w" name="p_new" placeholder="width"
								size="6" type="text" value=""></td>
							<td><input id="v_new_h" name="p_new" placeholder="height"
								size="6" type="text" value=""></td>
							<td></td>
							<td><a href="javascript:doDynoVideoCreative();">Add</a></td>
						</tr>
					</table>
					<!-- Modal -->
				</div>

				<div class="tab-pane fade" id="constraints">
					<table id="addconstraints">
						<tr>
							<th>Constraint Name</th>
							<th>Operation</th>
							<th>Constraint Value</th>
							<th>Required</th>
						</tr>
						<tr id="row0">
							<td><select id='p_new_constraint' name='p_new_constraint' class='basic-single' value=''>
								
							</select></td>
							<td><select class='form-control' id='opselect'>

									<!--#include virtual="COMPONENTS/operator_options.ssi" -->

							</select></td>
							<td><input id="p_new_value" name="p_new_values"
								placeholder="values are here" size="40" type="text" value=""></td>
							<td><input checked id="p_required" type="checkbox"></td>
							<td><a href="javascript:addNewConstraint();">Add</a></td>
						</tr>
					</table>
				</div>

				<div class="tab-pane fade" id="zstatus">
					<table id="addstatus" class="table table-striped">
						<tr>
							<th>Campaign</th>
							<th>Action</th>
						</tr>
						<tr id="row0">
							<td></td>
							<td></td>
						</tr>
					</table>
				</div>
			</div>


			<div class="modal fade" id="jsonDisplay" role="dialog">
				<div class="modal-dialog modal-lg">
					<!-- Modal content-->
					<div class="modal-content">
						<div class="modal-header modal-header-primary">
							<button class="close" data-dismiss="modal" type="button">&times;</button>
							<h2 class="modal-title">JSON CAMPAIGN VIEWER</h2>
						</div>
						<div class="modal-body">

							<textarea rows="30" cols="100" readonly id="campaignContents"></textarea>
							<br />


						</div>

					</div>
				</div>
			</div>
		
			<div class="modal fade" id="bannerModal" role="dialog">
				<div class="modal-dialog modal-lg">
					<!-- Modal content-->
					<div class="modal-content">
						<div class="modal-header modal-header-primary">
							<button class="close" data-dismiss="modal" type="button">&times;</button>
							<div id="bannerTitle">
								<h2 class="modal-title">BANNER Constraint Editor</h2>
							</div>
						</div>
						<div class="modal-body">
							<div id="modal-adx-banner" class="hidden">
								<div class="panel panel-info">
									<div class="panel-heading">
										<h3 class="panel-title">Adx Specification</h3>
									</div>
									<div class="panel-body">
										<table>
											<tr>
												<td>Click Through URL:</td>
												<td><input type='text' id='clickthroughurl' size='90'
													value='' placeholder='the click through url' /></td>
											</tr>
											<tr>
												<td>Tracking URL:</td>
												<td><input type='text' id='adxtrackingurl' size='90'
													value='' placeholder='the tracking URL' /></td>
											</tr>
											<tr>
												<td>Category:</td>
												<td><select id='banner-category' class="form-control"
													style="width: auto;">
														<!--#include virtual="COMPONENTS/adx_category_types.ssi" -->
												</select></td>
											</tr>
											<tr>
												<td>Vendor Type:</td>
												<td><select id='banner-vendor-type'
													class='form-control' style="width: auto;">
														<!--#include virtual="COMPONENTS/adx_vendor_types.ssi" -->
												</select></td>
											</tr>
											<tr>
												<td>Attributes:</td>
												<td><select id='banner-adx-attrs' multiple
													class="form-control" style="width: auto;">
														<!--#include virtual="COMPONENTS/adx_ad_attributes.ssi" -->
												</select></td>

											</tr>
										</table>
									</div>
								</div>
							</div>

							<div id="modal-cap-freq-banner" class="">

								<div class="panel panel-info">
									<div class="panel-heading">
										<h3 class="panel-title">Capping Frequency Specification</h3>
									</div>
									<div class="panel-body">
										Specification: <input type='text' id='banner-cap-spec'
											size='20' value=''
											placeholder='specification (e.g. device.ip)' /> Frequency: <input
											type='text' id='banner-cap-limit' size='20' value=''
											placeholder='how many allowed' /> Timeout (secs): <input
											type='text' id='banner-cap-timeout' size='20' value=''
											placeholder='timeout period' />
									</div>
								</div>
							</div>

							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Pricing, Deal</h3>
								</div>
								<div class="panel-body">
									<table>
										<tr>
											<td><b>Public Price (ecpm):</b></td>
											<td><input type='text' id='banner-public-price'
												size='20' value='' placeholder='Bid ecpm' /></td>
										</tr>
										<tr>
						<table id="bannerDeal">
						<tr>
							<th>Private/Preferred Deal Id</th>
							<th>Price</th>
						<tr id="row0">

							<td><input id="p_new_deal_id_bannerDeal" name="p_new"
								placeholder="Deal Id" size="32" type="text" value=""></td>

							<td><input id="p_new_deal_price_bannerDeal" name="p_new"
								placeholder="Price" size="8" type="text" value=""></td>
							<td><a href="javascript:addDeal('bannerDeal');">Add</a></td>
						</tr>
					</table>
					</tr>
					</table>
								</div>
							</div>
							
							
						<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Special Attributes</h3>
								</div>
								<div class="panel-body">
									
						<table id="bannerSpecialAttributes">
						<tr>
							<th>Key</th>
							<th>Value</th>
						<tr id="row0">

							<td><input id="p_new_attribute_key_bannerSpecialAttributes" name="p_new"
								placeholder="Key" size="32" type="text" value=""></td>

							<td><input id="p_new_attribute_value_bannerSpecialAttributes" name="p_new"
								placeholder="Value" size="32" type="text" value=""></td>
							<td><a href="javascript:addSpecialAttributes('bannerSpecialAttributes');">Add</a></td>
						</tr>
					</table>
								</div>
							</div>
							
							
							
							
							

							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Creative</h3>
								</div>
								<div class="panel-body">
									<textarea class="form-control" id="bannerForwardUrl" rows="5"></textarea>

									<div id='modal-banner-image-url'>
										<input class="form-control" id="bannerImageUrl"
											placeholder="Image URL" type="text">
									</div>
								</div>
							</div>

							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Constraints</h3>
								</div>
								<div class="panel-body">
									<table id="addbannerconstraints">
										<tr>
											<th>Constraint Name</th>
											<th>Operation</th>
											<th>Constraint Value</th>
											<th>Required</th>
										</tr>
										<tr id="row0">	
											<td><select id='banner_new_constraint' name='p_new_constraint' class='basic-single' value=''>
												
											</td>
												
												
												
												
												
												
											<td><select class='form-control' id='banner_opselect'>
													<!--#include virtual="COMPONENTS/operator_options.ssi" -->

											</select></td>
											<td><input id="banner_new_value" name="v_new_values"
												placeholder="values are here" size="40" type="text" value=""></td>
											<td><input checked id="banner_new_required" type="checkbox"></td>
											<td><a href="javascript:addNewBannerConstraint();">
													Add</a></td>
										</tr>
									</table>
								</div>
								<div class="modal-footer">
									<button class="btn btn-default" data-dismiss="modal"
										onclick='closeBannerModal();' type="button">Save and
										Close</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>


			<div class="modal fade" id="nativeModal" role="dialog">
				<div class="modal-dialog modal-lg">
					<!-- Modal content-->
					<div class="modal-content">
						<div class="modal-header modal-header-primary">
							<button class="close" data-dismiss="modal" type="button">&times;</button>
							<h2 class="modal-title">Native Ad Editor</h2>
						</div>
						<div class="modal-body">
							<div id="modal-adx-native" class="hidden">

								<div class="panel panel-warning">
									<div class="panel-heading">
										<h3 class="panel-title">Adx Specification</h3>
									</div>
									<div class="panel-body">
										<table>
											<tr>
												<td>Click Through URL:</td>
												<td><input type='text' id='native-clickthroughurl'
													size='90' value='' placeholder='the click through url'
													class="form-control" /></td>
											</tr>
											<tr>
												<td>Category</td>
												<td><input type='text' id='native-category' size='20'
													value='' placeholder='Category of the ad' /></td>
											</tr>
											<tr>
												<td>Vendor Type:</td>
												<td><input type='text' id='native-vendor-type'
													size='20' class="form-control" value=''
													placeholder='Vendor Type' /></td>
											</tr>
											<tr>
												<td>Attributes:</td>
												<td><input type='text' id='native-adx-attrs' size='20'
													value='' placeholder='Comma separated list'
													class="form-control" /></td>t
											</tr>
										</table>
									</div>
								</div>
							</div>

							<div id="modal-cap-freq-native">
								<div class="panel panel-warning">
									<div class="panel-heading">
										<h3 class="panel-title">Capping Frequency Specificatiom]</h3>
									</div>
									<div class="panel-body">
										<input type='text' id='native-cap-spec' size='20' value=''
											placeholder='specification (e.g. device.ip)' /> Frequency: <input
											type='text' id='native-cap-limit' size='20' value=''
											placeholder='how many allowed' /> Timeout (secs): <input
											type='text' id='native-cap-timeout' size='20' value=''
											placeholder='timeout period' />

									</div>
								</div>
							</div>
							
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Pricing, Deal</h3>
								</div>
								<div class="panel-body">
									<table>
										<tr>
											<td>Public Price (ecpm):</td>
											<td><input type='text' id='native-public-price'
												size='20' value='' placeholder='Bid ecpm' /></td>
										</tr>
											<tr>
						<table id="nativeDeal">
						<tr>
							<th>Private/Preferred Deal Id</th>
							<th>Price</th>
						<tr id="row0">

							<td><input id="p_new_deal_id_nativeDeal" name="p_new"
								placeholder="Deal Id" size="32" type="text" value=""></td>

							<td><input id="p_new_deal_price_nativeDeal" name="p_new"
								placeholder="Price" size="8" type="text" value=""></td>
							<td><a href="javascript:addDeal('nativeDeal');">Add</a></td>
						</tr>
					</table>
					</tr>
									</table>
								</div>
							</div>
						
						<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Special Attributes</h3>
								</div>
								<div class="panel-body">
										
					<table id="nativeSpecialAttributes">
						<tr>
							<th>Key</th>
							<th>Value</th>
						<tr id="row0">

							<td><input id="p_new_attribute_key_nativeSpecialAttributes" name="p_new"
								placeholder="Key" size="32" type="text" value=""></td>

							<td><input id="p_new_attribute_value_nativeSpecialAttributes" name="p_new"
								placeholder="Value" size="32" type="text" value=""></td>
							<td><a href="javascript:addSpecialAttributes('nativeSpecialAttributes');">Add</a></td>
						</tr>
					</table>
								</div>
							</div>		
							

							<div class="panel panel-warning">
								<div class="panel-heading">
									<h3 class="panel-title">Required</h3>
								</div>
								<div class="panel-body">
									<input class="form-control" id="native-url"
										placeholder="The main url" type="text"> <input
										class="form-control" id="native-fallbackurl"
										placeholder="The fallback url" type="text">
									<div class="panel panel-info">
										<div class="panel-heading">
											<h3 class="panel-title">Click Trackers</h3>
										</div>
										<div class="panel-body">
											<table id="addclicktrackers">
												<tr>
													<th>Click Tracking URLS</th>
												</tr>
												<tr>
													<td></td>
												</tr>
												<tr id="row0">
													<td><input class="form-control" id="new-clicktrack"
														placeholder="The click tracking URL" size="50" type="text"></td>
													<td></td>
													<td><a href="javascript:doDynoClickTracker();">
															Add</a></td>
												</tr>
											</table>
										</div>
									</div>
									<div class="panel panel-info">
										<div class="panel-heading">
											<h3 class="panel-title">Impression Trackers</h3>
										</div>
										<div class="panel-body">
											<table id="addimpressiontrackers">
												<tr>
													<th>Impression Tracking URLS</th>
												</tr>
												<tr>
													<td></td>
												</tr>
												<tr id="row0">
													<td><input class="form-control"
														id="new-impressiontrack"
														placeholder="The impression tracking URL" size="50"
														type="text"></td>
													<td></td>
													<td><a href="javascript:doDynoImpressionTracker();">
															Add</a></td>
												</tr>
											</table>
										</div>
									</div>
								</div>
							</div>
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Title</h3>
								</div>
								<div class="panel-body">
									<input class="form-control" id="native-ad-title"
										placeholder="Title of the ad" type="text"> <input
										class="form-control" id="native-ad-title-cta"
										placeholder="Call to action URL" type="text">
								</div>
							</div>
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Image</h3>
								</div>
								<div class="panel-body">
									<input class="form-control" id="native-ad-image-url"
										placeholder="Image URL" type="text"> W: <input
										id='native-ad-image-w' placeholder='width' size='6'
										type='text' value=''> H: <input id='native-ad-image-h'
										placeholder='height' size='6' type='text' value=''> <input
										class="form-control" id="native-ad-image-cta"
										placeholder="Call to action URL" type="text">
								</div>
							</div>
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Video</h3>
								</div>
								<div class="panel-body">
									Duration (secs): <input id='native-image-duration'
										placeholder='0.0' size='10' type='text' value=''>
									Protocol: <select class="selectpicker"
										id="native-image-protocol">
										<option value="VAST 1.0">VAST 1.0</option>
										<option selected value="VAST 2.0">VAST 2.0</option>
										<option value="VAST 3.0">VAST 3.0</option>
										<option value="VAST 1.0 Wrapper">VAST 1.0 Wrapper</option>
										<option value="VAST 2.0 Wrapper">VAST 2.0 Wrapper</option>
										<option value="VAST 3.0 Wrapper">VAST 3.0 Wrapper</option>
									</select> Linearity: <input id="native-image-linearity" size="5"
										type="text" value="0"> <input class="form-control"
										id="native-image-xml" type="text" value="XML Goes Here">
								</div>
							</div>
							<div class="panel panel-warning">
								<div class="panel-heading">
									<h3 class="panel-title">Link</h3>
								</div>
								<div class="panel-body">
									<input class="form-control" id="native-ad-link-url"
										placeholder="Link URL" type="text"> <input
										class="form-control" id="native-ad-link-fallback-url"
										placeholder="Link Fallback URL" type="text">
								</div>
							</div>
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Data Assets</h3>
								</div>
								<div class="panel-body">
									<table id="addassets">
										<tr>
											<th>Data Type</th>
											<th>Data Asset Value</th>
											<th>Call to Action</th>
										</tr>
										<tr id="row0">
											<td><select class="selectpicker"
												id="p_new_data_asset_type">
													<option>Sponsored</option>
													<option selected>Descriptive text</option>
													<option>Rating</option>
													<option>Likes</option>
													<option>Downloads</option>
													<option>Price</option>
													<option>Sale Price</option>
													<option>Phone</option>
													<option>Address</option>
													<option>Additional description</option>
													<option>Display URL for the text ad</option>
													<option>Call To Action Text</option>
											</select></td>
											<td><input id='p_new_data_asset_value'
												placeholder='Data value' size='30' type='text' value=''></td>
											<td><input id='p_new_data_coa_value'
												placeholder='Call to action value' size='30' type='text'
												value=''></td>
											<td><a href="javascript:doDynoAssets();"> Add</a></td>
										</tr>
									</table>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button class="btn btn-default" data-dismiss="modal"
								onclick='closeNativeModal();' type="button">Save and
								Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Modal -->
		<div class="modal fade" id="videoModal" role="dialog">
			<div class="modal-dialog modal-lg">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header modal-header-primary">
						<button class="close" data-dismiss="modal" type="button">&times;</button>
						<h2 class="modal-title">VIDEO Editor</h2>

						<div id="modal-adx-video" class="hidden">
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Adx Specification</h3>
								</div>
								<div class="panel-body">
									<table>
										<tr>
											<td>Click Through URL:</td>
											<td><input type='text' id='video-clickthroughurl'
												size='90' value='' placeholder='the click through url'
												class="form-control" /></td>
										</tr>
										<tr>
											<td>Category:</td>
											<td><select id='video-category' class="form-control"
												style="width: auto;">
													<!--#include virtual="COMPONENTS/adx_category_types.ssi" -->
											</select></td>
										</tr>
										<tr>

											<td>Vendor Type:</td>
											<td><select id='video-vendor-type' class='form-control'
												style="width: auto;">
													<!--#include virtual="COMPONENTS/adx_vendor_types.ssi" -->
											</select></td>
										</tr>
										<tr>
											<td>Attributes:</td>
											<td><select id='video-adx-attrs' multiple
												class="form-control" style="width: auto;">
													<!--#include virtual="COMPONENTS/adx_ad_attributes.ssi" -->
											</select></td>
										</tr>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div class="modal-body">

						<div id="modal-cap-freq-video">
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Capping Frequency Specification</h3>
								</div>
								<div class="panel-body">
									<input type='text' id='video-cap-spec' size='20' value=''
										placeholder='specification (e.g. device.ip)' /> Frequency: <input
										type='text' id='video-cap-limit' size='20' value=''
										placeholder='how many allowed' /> Timeout (secs): <input
										type='text' id='video-cap-timeout' size='20' value=''
										placeholder='timeout period' />

								</div>
							</div>
						</div>
						
						<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Pricing, Deal</h3>
								</div>
								<div class="panel-body">
									<table>
										<tr>
											<td>Public Price (ecpm):</td>
											<td><input type='text' id='video-public-price'
												size='20' value='' placeholder='Bid ecpm' /></td>
										</tr>
	<tr>
						<table id="videoDeal">
						<tr>
							<th>Private/Preferred Deal Id</th>
							<th>Price</th>
						<tr id="row0">

							<td><input id="p_new_deal_id_videoDeal" name="p_new"
								placeholder="Deal Id" size="32" type="text" value=""></td>

							<td><input id="p_new_deal_price_videoDeal" name="p_new"
								placeholder="Price" size="8" type="text" value=""></td>
							<td><a href="javascript:addDeal('videoDeal');">Add</a></td>
						</tr>
					</table>
					</tr>
									</table>
								</div>
							</div>
					
				<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Special Attributes</h3>
								</div>
								<div class="panel-body">
											
				<table id="videoSpecialAttributes">
						<tr>
							<th>Key</th>
							<th>Value</th>
						<tr id="row0">

							<td><input id="p_new_attribute_key_videoSpecialAttributes" name="p_new"
								placeholder="Key" size="32" type="text" value=""></td>

							<td><input id="p_new_attribute_value_videoSpecialAttributes" name="p_new"
								placeholder="Value" size="32" type="text" value=""></td>
							<td><a href="javascript:addSpecialAttributes('videoSpecialAttributes');">Add</a></td>
						</tr>
					</table>
								</div>
							</div>

						<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Video Specification</h3>
								</div>
								
							
								<div class="panel-body">
							
							<label for="video-protocol">Protocol:</label> <select select class='form-inline' id='video-protocol' style="width: 200px">

										<option value="1">VAST 1.0</option>
										<option selected value="2">VAST 2.0</option>
										<option value="3">VAST 3.0</option>
										<option value="4">VAST 1.0 Wrapper</option>
										<option value="5">VAST 2.0 Wrapper</option>
										<option value="6">VAST 3.0 Wrapper</option>

								</select>
								
						    <label for "video-linearity">Linearity</label> <input
							id="video-linearity" placeholder="Linearity" size="5" type="text" value "">
							
							<label for="video-mime">Mime:</label> <select select class='form-inline' id='video-mime' style="width: 200px">

										<!--#include virtual="COMPONENTS/video_options.ssi" -->

								</select>
							
							<label for "video-duration">Length:</label><input
							id="video-duration" placeholder="Duration" size="5" type="text"value="30"><br> 
							
							<label for="comment">Raw Video
							Tags:</label>
						<textarea class="form-control" id="rawVideo" rows="10"></textarea>
						<button class="btn btn-default" onclick='doFormatXML(false);'
							type="button">Format</button>
						<button class="btn btn-default" onclick='doFormatXML(true);'
							type="button">Minify</button>
						</div></div>
							<div class="panel panel-info">
								<div class="panel-heading">
									<h3 class="panel-title">Constraints</h3>
								</div>
								<div class="panel-body">
						<table id="addvideoconstraints">
							<tr>
								<th>Constraint Name</th>
								<th>Operation</th>
								<th>Constraint Value</th>
								<th>Required</th>
							</tr>
							<tr id="row0">
							<td><select id='v_new_constraint' name='p_new_constraint' class='basic-single' value=''>
								
							</select></td>
							
								<td><select class='form-control' id='vopselect'>

										<!--#include virtual="COMPONENTS/operator_options.ssi" -->

								</select></td>
								<td><input id="v_new_value" name="v_new_values"
									placeholder="values are here" size="40" type="text" value=""></td>
								<td><input checked id="v_new_required" type="checkbox"></td>
								<td><a href="javascript:addNewVideoConstraint();"> Add</a></td>
							</tr>
						</table>
						</div></div>
					</div>
					<div class="modal-footer">
						<button class="btn btn-default" data-dismiss="modal"
							onclick='closeVideModal();' type="button">Save and Close</button>
					</div>
				</div>
			</div>
			<!-- Modal -->


		</div>
	</div>
	</div>
	<script>
		userName = null;
		currentCampaign = null;
		videoCreative = null; // the video creative last edited in the modal dialog
		videoEditorCell = null; // the row of the video creative edited in the modal dialog
		disableTabs(true);
		campaignDeletions = [];
		function submitForm() {
			var fd = new FormData();
			var name = document.getElementById("file-name").value;
			fd.append('file', $('input[type=file]')[0].files[0]);
			fd.append('name', name);
			$.ajax({
				url : "upload",
				type : "POST",
				dataType : 'json',
				data : fd,
				enctype : 'multipart/form-data',
				processData : false, // tell jQuery not to process the data
				contentType : false
			// tell jQuery not to set contentType
			}).done(function(data) {
				images = data.images;
				imagesTable.clear();
				loadImages();
			});
			return false;
		}
		function loadImages() {
			if (typeof images === 'undefined')
				return;
			for (var i = 0; i < images.length; i++) {
				imagesTable.add([ images[i].uri, images[i].name, '' ]);
			}
		}
		function revert() {
			clearFields();
			doFormLogin();
		}
		function doFormLogin() {
			userName = document.getElementById("username").value;
			var password = document.getElementById("password").value;
			console.log("U=" + userName + ", P=" + password);
			document.getElementById("selected").innerHTML = userName;
			if (userName === 'demo') {
				doDemo();
			}
			//setTimeout(function(){window.location.href='campaign'},0);
			msg = {};
			msg.command = "login";
			msg.username = userName;
			msg.password = password;
			////////////////////
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(msg),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {
						text = request.responseText;
						data = JSON.parse(text);
						message = data.message;
						text = JSON.stringify(data, null, 2);
						console.log("-----------------");
						console.log(text);
					}
					if (data.error) {
						doModal(BootstrapDialog.TYPE_DANGER, "Error",
								"Error logging in");
						return;
					} else {
						var ele = document.getElementById("login");
						ele.style.display = "none";
						ele = document.getElementById("bs-example");
						ele.style.display = "block";
						clearFields();
						//userName = name = data.username;

						$('#p_user_pass').val(password);
						$('#p_user_phone').val(data.userPhone);
						$('#p_user_email').val(data.userEmail);
						$('#p_user_credit').val(data.userCredit);

						camps = data.campaigns;
						running = data.running;
						for (i = 0; i < camps.length; i++) {
							campaign = camps[i];
							dyno.add([ campaign.owner, campaign.adId, '' ]);
							value = campStatus.add([ campaign.adId, '' ]);
							console.log("ADDED: " + value);
						}
						updateStatus(running);
						images = data.images;
						loadImages();
					}
				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_INFO, "Error",
							request.responseText);
				}
			});
			////////////////////
		}
		$(document).ready(function() {
			$(".tip-top").tooltip({
				placement : 'top'
			});
			$(".tip-right").tooltip({
				placement : 'right'
			});
			$(".tip-bottom").tooltip({
				placement : 'bottom'
			});
			$(".tip-left").tooltip({
				placement : 'left'
			});
		});
		$(document).ready(function() {
			$('[data-toggle="tooltip"]').tooltip();
		});

		function saveChanges() {
			/*
			 * Get selected campaign name
			 * Get the running status of this campaign
			 * Load the attributes
			 * Load the templates
			 * Load the creatives
			 * Load the constraints
			 * Upload with jquery
			 * If running then print a message you have to stop/start for the system to take effect
			 */
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}

			if (document.getElementById("adomain").value == "") {
				if (deletions.length != 0) {
					writeDeletedCampaigns();
					return;
				}
				doModal(BootstrapDialog.TYPE_WARN, "Warning",
						"You haven't selected a campaign yet");
				return;
			}
			/* Attributes */
			var x = getCampaign(currentCampaign);
			var zulu = jQuery.extend(true, {}, x);

			var forensiqs = document.getElementById('forensiqs').value;
			if (forensiqs == 'true') {
				zulu.forensiq = true;
			} else {
				zulu.forensiq = false;
			}

			if ($('#is-adx').find(":selected").text() == 'Yes')
				zulu.isAdx = true;
			else
				zulu.isAdx = false;
			zulu.adomain = document.getElementById("adomain").value;
			zulu.adId = document.getElementById("adid").value = currentCampaign;
			d1 = document.getElementById("startdate").value;
			d2 = document.getElementById("enddate").value;
			zulu.dates = [];
			zulu.dates.push(Number(d1));
			zulu.dates.push(Number(d2));
			zulu.creatives = [];
			/* banner creatives */

			table = document.getElementById("addcreative");
			rows = table.rows;
			for (i = 2; i < rows.length; i++) {
				var c = rows[i].cells[1].children[0].value;
				var d = rows[i].cells[2].children[0].checked; // override
				var e = rows[i].cells[3].children[0].value;
				var f = rows[i].cells[4].children[0].value;
				creative = getCreative(x, c);

				if (creative == null)
					creative = {}

				creative.impid = c;
				creative.adm_override = d;
				creative.w = e;
				creative.h = f;

				if (zulu.isAdx && !creative.adxCreativeExtensions) {
					creative.adxCreativeExtensions = {}
				}

				//creative.forwardurl = document.getElementById('bannerForwardUrl').value;
				//creative.imageurl = document.getElementById('bannerImageUrl').value;

				zulu.creatives.push(creative);

			}

			/* Video creatives */
			table = document.getElementById("addvideocreative");
			rows = table.rows;
			for (i = 2; i < rows.length; i++) {
				a = rows[i].cells[1].children[0].value; // impression id
				b = rows[i].cells[2].children[0].value; // width
				c = rows[i].cells[3].children[0].value; // height

				creative = getCreative(x, a)
				if (creative == null)
					creative = {}

				creative.impid = a;
				creative.w = b;
				creative.h = c;
;

				if (zulu.isAdx && !creative.adxCreativeExtensions) {
					creative.adxCreativeExtensions = {}
				}

				zulu.creatives.push(creative);
			}
			/* Native creatives */
			table = document.getElementById("addnative");
			rows = table.rows;
			for (i = 2; i < rows.length; i++) {
				id = rows[i].cells[1].children[0].value;
				type = rows[i].cells[2].children[0].value;

				creative = getCreative(x, id)
				if (creative == null)
					creative = {}

				creative.impid = id;
				creative.type = getNativeAdType(type);

				zulu.creatives.push(creative);
			}
			/* constraints */
			zulu.attributes = makeAttributes("addconstraints");
			console.log(JSON.stringify(zulu, null, 2));
			///////////////////
			data = {
				command : 'updatecampaign',
				username : userName,
				deletions : deletions,
				id : zulu.adId,
				campaign : JSON.stringify(zulu, null, 2)
			};
			$
					.ajax({
						type : 'POST',
						url : 'ajax',
						data : JSON.stringify(data),
						dataType : 'json',
						success : function(data, textStatus, request) {
							if (request.status == 204) {
								text = "";
							} else {
								replaceCampaign(currentCampaign,zulu);
								text = request.responseText;
								data = JSON.parse(text);
								if (data.campaigns != null) {
									camps = data.campaigns;
								}
								message = data.message;
								text = JSON.stringify(data, null, 2);
								console.log("-----------------");
								console.log(text);
							}
							if (data.error)
								doModal(BootstrapDialog.TYPE_INFO, "Error",
										message);
							else {
								campaign = zulu;
								doModal(BootstrapDialog.TYPE_SUCCESS,
										"Update succeeded",
										"If this campaign is running it has already been reloaded.");
							}
							deletions = [];
						},
						error : function(request, textStatus, errorThrown) {
							doModal(BootstrapDialog.TYPE_INFO, "HTTP Error",
									request.responseText);
						}
					});
			//////////////////
		}
		
		function makeAttributes(tablename) {
			var attributes = [];
			var table = document.getElementById(tablename);
			var rows = table.rows;
			for (i = 2; i < rows.length; i++) {
				var a = rows[i].cells[0].children[0].value;
				var a = a.split(".");
				var b = rows[i].cells[1].children[0].value;
				var c
				try {
				   c = eval(rows[i].cells[2].children[0].value);
				} catch (err) {
					c = "" + rows[i].cells[2].children[0].value + ""
				}
				var d = rows[i].cells[3].children[0].checked;
				var obj = {};
				obj.bidRequestValues = a;
				obj.op = b;
				obj.value = c;
				obj.notPresentOk = !d;
				attributes.push(obj);
			}
			return attributes;
		}

		function writeDeletedCampaigns() {
			data = {
				command : 'writeDeletedCampaigns',
				username : userName,
				deletions : deletions
			};
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(data),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {

						text = request.responseText;
						data = JSON.parse(text);

						camp = data.campaign;
						camps.push(camp);
						message = data.message;
						text = JSON.stringify(data, null, 2);

					}
					//  console.log("data = " + JSON.stringify(camps,null,2));
					if (message != null && message != "")
						doModal(BootstrapDialog.TYPE_ERROR, "Error", message);
					deletions = [];
				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});

			////////////////////////////////////////////////////
		}

		function doDyno() {
			var newName = document.getElementById("ad_domain").value;
			if (newName == '') {
				doModal(BootstrapDialog.TYPE_INFO, "Error",
						"Can't have a blank ad domain");
				return;
			}

			///////////////////////////////////////////////////
			data = {
				command : 'stub',
				username : userName,
				campaign : newName
			};
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(data),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {

						text = request.responseText;
						data = JSON.parse(text);

						camp = data.campaign;
						camps.push(camp);
						message = data.message;
						text = JSON.stringify(data, null, 2);

					}
					//  console.log("data = " + JSON.stringify(camps,null,2));
					if (message != null && message != "")
						doModal(BootstrapDialog.TYPE_INFO, "Error", message);

					dyno.add([ camp.owner, camp.adId, '' ]);
					document.getElementById("ad_domain").value = "";
					campStatus.add([ camp.adId, '' ]);
				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});

			////////////////////////////////////////////////////

		}

		/* Add click tracking URLS */
		function doDynoClickTracker() {
			var url = document.getElementById('new-clicktrack').value;
			clickDyno.add([ url ]);
			docuemnt.getElementById('new-clicktrack').value = '';
		}

		/* Add impressopm tracking URLS */
		function doDynoImpressionTracker() {
			var url = document.getElementById('new-impressiontrack').value;
			impressionDyno.add([ url ]);
			document.getElementById('new-impressiontrack').value = '';
		}

		/* add native data asset */
		function doDynoAssets() {
			var type = document.getElementById("p_new_data_asset_type");
			var val = document.getElementById("p_new_data_asset_value");
			var coa = document.getElementById("p_new_data_coa_value");
			assetsDyno.add([ type.value, coa.value ]);
			val.value = "";
		}

		/* add native ad creative */
		function doDynoNative() {
			var impid = document.getElementById("p_new_impid_native");
			var type = document.getElementById("p_new_native_type");
			var price = document.getElementById("p_new_native_price");
			var cur = document.getElementById("p_new_native_cur");
			natDyno.add([ '', impid.value, type.value,'' ]);

			var nat = {};
			nat.impid = impid.value;
			nat.type = type.value;
			nat.price = price.value;
			nat.currency = cur.value;
			nat.attributes = [];
			if (campaign.isAdx) {
				nat.adxCreativeExtension = {};
				nat.adxCreativeExtension.adxTrackingUrl = '';
				nat.adxCreativeExtension.adCategory = '';
				nat.adxCreativeExtension.adxVendorType = ''
				nat.adxCreativeExtension.attributes = []
			}
			nat.nativead = {};
			nat.nativead.link = {};
			nat.nativead.link.url = '';
			nat.nativead.link.fallback = '';
			nat.nativead.link.clicktrackers = [];
			nat.nativead.imptrackers = [];
			nat.nativead.assets = [];

			impid.value = '';
			price.value = "0.0";

			campaign.creatives.push(nat);
		}

		/* add banner creative */
		function doDynoCreative() {
			var impid = document.getElementById("p_new_impid");
			var override = document.getElementById('p_new_ot');
			var w = document.getElementById("p_new_w");
			var h = document.getElementById("p_new_h");
			var price = document.getElementById("p_new_price");
			var cur = document.getElementById("p_new_cur");
			var override = document.getElementById("p_new_ot").checked;

			var campaign = getCampaign(currentCampaign);
			/** Make the banner creative */
			var banner = {};
			banner.impid = impid.value;
			banner.adm_override = override;
			banner.w = w.value;
			banner.h = h.value;
			banner.attributes = [];
			banner.price = 0;
			/** add to the creatives */
			campaign.creatives.push(banner);

			/** add the row */
			creativeDyno.add([ '', impid.value, override, w.value, h.value,
					'', '', '' ]);
			impid.value = w.value = h.value = '';

			currentCampaign = campaign.adId;
		}

		/* Create a new video impression object */
		function doDynoVideoCreative() {
			var impid = document.getElementById("v_new_impid");
			var w = document.getElementById("v_new_w");
			var h = document.getElementById("v_new_h");

			var campaign = getCampaign(currentCampaign);
			var creative = getCreative(campaign, impid.value);
			var vadm = document.getElementById('rawVideo');
			
			var proto_opt = document.getElementById('video-protocol');
			
			var mime = document.getElementById('video-mime');
		    var opt = mime.options[mime.selectedIndex];
			
			var duration = document.getElementById('video-duration');
			var linearity = document.getElementById('video-linearity');

			if (creative != null) {
				alert("This impression id already exists");
				return;
			}

			videoCreative = {};
			videoCreative.impid = impid.value;
			videoCreative.w = w.value;
			videoCreative.h = h.value;
			videoCreative.price = 0;
			videoCreative.currency = "";
			videoCreative.attributes = [];
			videoCreative.adm = vadm.value.split("\n");

			if (proto_opt.value != '')
				videoCreative.videoProtocol = Number(proto_opt.value);
			if (mime.value != '')
				videoCreative.videoMimeType = opt.value;
			if (duration.value != '')
				videoCreative.videoDuration = Number(duration.value);
			if (linearity.value != '')
				videoCreative.videoLinearity = Number(linearity.value);
			else
				videoCreative.videoLinearity = 1;
			
			campaign.creatives.push(videoCreative);

			videoCreativeDyno.add([ '', impid.value, w.value, h.value,'', '' ]);
			impid.value = w.value = h.value = vadm.value  = ''
			vdyno.clear();
			document.getElementById('rawVideo').value = '';
			document.getElementById('video-protocol').value = '';
			document.getElementById('video-linearity').value = '';
			document.getElementById('video-mime').value = '';
			document.getElementById('video-duration').value = '';

			currentCampaign = campaign.adId;

		}

		/* Find creative impid in the campaign */
		function getCreative(campaign, impid) {
			for (var i = 0; i < campaign.creatives.length; i++) {
				if (campaign.creatives[i].impid == impid)
					return campaign.creatives[i];
			}
			return null;
		}

		/*
		 * iterate through the row of the table, when you find one in the list of running
		 * update the start stop button
		 */
		function updateStatus(running) {
			/** 
			 * Update the status pane
			 */
			table = document.getElementById("addstatus");
			rows = table.rows;
			for (var i = 2; i < rows.length; i++) {
				row = rows[i];
				cell = row.cells[0];
				label = cell.innerText;
				cell = row.cells[1];
				button = cell.children[0];
				text = button.value;
				button.style.background = "#A9A9A9";
				for (var j = 0; j < running.length; j++) {
					if (label == running[j]) {
						button.value = "Stop";
						button.style.background = '#7FFF00';
					}
				}
				console.log(text);
			}
			/*
			 * Update the main pane 
			 */
			table = document.getElementById("addinput");
			rows = table.rows;
			for (var i = 2; i < rows.length; i++) {
				row = rows[i];
				cell = row.cells[1];
				button = cell.children[0];
				label = button.value;
				button.style.background = "#A9A9A9";
				for (var j = 0; j < running.length; j++) {
					if (label == running[j]) {
						button.style.background = '#7FFF00';
					}
				}
			}
		}
		function getCampaign(id) {
			for (var i = 0; i < camps.length; i++) {
				var camp = camps[i];
				if (camp.adId == id)
					return camp;
			}
			return null;
		}
		
		function replaceCampaign(id,newCamp) {
			for (var i = 0; i < camps.length; i++) {
				var camp = camps[i];
				if (camp.adId == id) {
					camps[i] =  newCamp;
					return;
				}
			}
		}
		
		function clearFields() {
			dyno.clear();
			campStatus.clear();
			cdyno.clear();
			vdyno.clear();
			videoCreativeDyno.clear();
			creativeDyno.clear();
			clickDyno.clear();
			natDyno.clear();
			impressionDyno.clear();
			videoSpecialDyno.clear();
			bannerSpecialDyno.clear();
			nativeSpecialDyno.clear();
			videoDealDyno.clear();
			bannerDealDyno.clear();
			nativeDealDyno.clear()
			
			currentCampaign = null;
			images = [];
			imagesTable.clear();
			document.getElementById("selection").innerHTML = "Selected: None";
			document.getElementById("adomain").value = "";
			document.getElementById("adid").value = "";
			document.getElementById("startdate").value = "";
			document.getElementById("enddate").value = "";
		}

		function deleteCampaign(what, id) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return	
			}
			var row = dyno.getRow(what);
			var cell = row.cells[0];
			var object = cell.children[0];
			var owner = object.value;

			cell = row.cells[1];
			object = cell.children[0];
			var name = object.value;

			///////////////////
			data = {
				command : 'deletecampaign',
				username : owner,
				campaign : name
			};
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(data),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {
						text = request.responseText;
						data = JSON.parse(text);
						if (data.campaigns != null) {
							camps = data.campaigns;
						}
						message = data.message;
						text = JSON.stringify(data, null, 2);
						console.log("-----------------");
						console.log(text);
					}
					if (message != null && message != "")
						doModal(BootstrapDialog.TYPE_INFO, "Error", message);

					dyno.remove(what);
					deleteStatusRowById(name);

					deletions.push(name);

				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});
			//////////////////
			//////////////////

		}

		function saveFile() {
			var msg = {
				command : 'dumpfile',
				username : userName
			}
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(msg),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {
						text = request.responseText;
						data = JSON.parse(text);
						if (data.campaigns != null) {
							camps = data.campaigns;
						}
						message = data.message;
						text = JSON.stringify(data, null, 2);
						console.log("-----------------");
						console.log(text);
					}
					if (data.error === true)
						doModal(BootstrapDialog.TYPE_ERROR, "Error", message);
					else
						doModal(BootstrapDialog.TYPE_INFO, "Info", message);

				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});
		}
		function deleteAssetsRow(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}

			console.log("DELETE WHAT: " + what);
			x = document.getElementById(what);
			console.log("val = " + x.value);
			assetsDyno.remove(what);
		}
		function deleteStatusRowById(id) {
			table = document.getElementById("addstatus");
			rows = table.rows;
			for (var i = 2; i < rows.length; i++) {
				row = rows[i];
				cell = row.cells[0];
				label = cell.innerText;
				if (label == id) {
					delid = row.id;
					campStatus.remove(delid);
					return;
				}
			}
		}
		function processCampaign(what) {
			var x = document.getElementById(what).value;
			console.log("PROCESS WHAT: " + x);
			videoCreativeDyno.clear();
			creativeDyno.clear();
			natDyno.clear();
			videoCreative = null;
			videoEditorCell = null;
			document.getElementById("selection").innerHTML = "Selected: " + x;
			disableTabs(false);
			for (var i = 0; i < camps.length; i++) {
				var c = camps[i];
				if (c.adId == x) {
					if (c.isAdx && c.isAdx == true) {
						$('#p_new_constraint').empty().append(adxConstraints);	
						$('#v_new_constraint').empty().append(adxConstraints);
						$('#banner_new_constraint').empty().append(adxConstraints);
						// tbd native						
						
						$("#modal-adx-banner").removeClass('hidden');
						$("#modal-adx-video").removeClass('hidden');
						$("#modal-adx-native").removeClass('hidden');
						$("#modal-cap-freq-banner").addClass('hidden');
						$("#modal-cap-freq-video").addClass('hidden')
						$("#modal-cap-freq-native").addClass('hidden')
						$("#modal-banner-image-url").addClass('hidden')
						$('#is-adx').val('Yes');
					} else {
						$('#p_new_constraint').empty().append(rtbConstraints);	
						$('#v_new_constraint').empty().append(rtbConstraints);
						$('#banner_new_constraint').empty().append(rtbConstraints);
						// tbd native	
						
						
						$('#is-adx').val('No');
						$("#modal-adx-banner").addClass('hidden');
						$("#modal-adx-video").addClass('hidden');
						$("#modal-adx-native").addClass('hidden');
						$("#modal-cap-freq-banner").removeClass('hidden');
						$("#modal-cap-freq-video").removeClass('hidden');
						$("#modal-cap-freq-native").removeClass('hidden');
						$("#modal-banner-image-url").removeClass('hidden')
					}
					document.getElementById("adomain").value = c.adomain;
					document.getElementById("adid").value = c.adId;
					document.getElementById("startdate").value = c.date[0];
					document.getElementById("enddate").value = c.date[1];
					cdyno.clear();
					for (var k = 0; k < c.attributes.length; k++) {
						var attribute = c.attributes[k];
						var left = makeDottedAttribute(attribute);
						var op = attribute.op;
						var right = JSON.stringify(attribute.value);
						var req = c.checked;						
						cdyno.add([ left, op, right, !req, "" ]);
						console.log(JSON.stringify(attribute, null, 2));
					}
					creativeDyno.clear();
					for (var j = 0; j < c.creatives.length; j++) {
						var creative = c.creatives[j];
						if (typeof creative.currency === 'undefined')
							creative.currency = '';
						if (typeof creative.videoDuration != 'undefined') { // video ad
							videoCreativeDyno.add([ '', creative.impid,
									creative.w, creative.h, '' ]);
						} else if (typeof creative.nativead == 'undefined') { // banner ad
							creativeDyno.add([ '', creative.impid,
									creative.adm_override, creative.w,
									creative.h, '', '' ]);
						} else {
							var type = nativeAdTypes[creative.nativead.nativeAdType];
							natDyno.add([ '', creative.impid, type,'' ]);
						}
					}
					currentCampaign = c.adId;
					if (c.forensiq == true)
						document.getElementById('forensiqs').value = "true";
					else
						document.getElementById('forensiqs').value = "false";
				}
			}
		}
		function deleteConstraintRow(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			console.log("DELETE WHAT: " + what);
			x = document.getElementById(what);
			console.log("val = " + x.value);
			cdyno.remove(what);
		}
		function deleteVideoConstraintRow(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			console.log("DELETE WHAT: " + what);
			x = document.getElementById(what);
			console.log("val = " + x.value);
			crdyno.remove(what);
		}
		function deleteVideoCreative(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			console.log("DELETE WHAT: " + what);
			videoCreativeDyno.remove(what);
		}
		function deleteNativeCreative(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			console.log("DELETE WHAT: " + what);
			natDyno.remove(what);
		}
		function deleteNativeClickTracking(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			clickDyno.remove(what);
		}
		function deleteNativeImpressionTracking(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			impressionDyno.remove(what);
		}

		function deleteCreative(what) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			console.log("DELETE WHAT: " + what);
			x = document.getElementById(what);
			console.log("val = " + x.value);
			creativeDyno.remove(what);
		}
		function addNewConstraint() {
			a = document.getElementById("p_new_constraint");
			op = document.getElementById("opselect");
			b = document.getElementById("p_new_value");
			req = document.getElementById("p_required").checked;
			vals = [];
			vals.push(a.value);
			vals.push(op.value);
			vals.push(b.value);
			vals.push( req );
			vals.push("");
			cdyno.add(vals);
			a.value = ''
			b.value = ''
		}
		function addNewVideoConstraint() {
			a = document.getElementById("v_new_constraint");
			op = document.getElementById("vopselect");
			b = document.getElementById("v_new_value");
			c = document.getElementById("v_new_required");
			vals = [];
			vals.push(a.value);
			vals.push(op.value);
			vals.push(b.value);
			vals.push( c.checked );
			vals.push("");
			vdyno.add(vals);
			a.value = '';
			b.value = '';
		}
		function addNewBannerConstraint() {
			a = document.getElementById("banner_new_constraint");
			op = document.getElementById("banner_opselect");
			b = document.getElementById("banner_new_value");
			c = document.getElementById("banner_new_required");
			vals = [];
			vals.push(a.value);
			vals.push(op.value);
			vals.push(b.value);
			vals.push( c.checked );
			vals.push("");
			crdyno.add(vals);
			a.value = '';
			b.value = '';
		}
		function startStop(rowId) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't stop or start campaigns.");
				return
			}
			console.log("A=" + rowId);
			row = document.getElementById(rowId);
			cell = row.cells[0];
			a = cell.textContent;
			cell = row.cells[1];
			inp = cell.children[0];
			b = inp.value;
			campaign = getCampaign(a);
			msg = {};
			msg.username = userName;
			if (b == 'Start') {
				inp.value = 'Pending...';
				msg.command = 'startcampaign';
				msg.id = campaign.adId;
			} else {
				msg.command = 'stopcampaign';
				msg.id = campaign.adId;
				inp.value = "Start"
			}
			////////////////////
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(msg),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {
						text = request.responseText;
						data = JSON.parse(text);
						message = data.message;
						text = JSON.stringify(data, null, 2);
						console.log("-----------------");
						console.log(text);
					}
					if (data.error)
						doModal(BootstrapDialog.TYPE_INFO, "Error", message);

					updateStatus(data.running);
				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});
			////////////////////
		}
		function deleteImageRow(rowId) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}

			console.log("ROWID = " + rowId);
			row = document.getElementById(rowId);
			row = document.getElementById(rowId);
			cell = row.cells[1];
			a = cell.textContent;
			console.log("Remove: " + a);
			imagesTable.remove(rowId);
			////////////////////
			msg = {};
			msg.command = 'deletefile';
			msg.file = a;
			msg.username = userName;
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(msg),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {
						text = request.responseText;
						data = JSON.parse(text);
						message = data.message;
						text = JSON.stringify(data, null, 2);
						console.log("-----------------");
						console.log(text);
					}
					if (data.error)
						doModal(BootstrapDialog.TYPE_INFO, "Error", message);

					/// do the business here
				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});
			////////////////////
		}
		function runNativeModal(id) {
			var row = document.getElementById(id);
			var cell = row.cells[1];
			savedImpressionId = cell.children[0].value;
			var campaign = getCampaign(currentCampaign);
			creat = getCreative(campaign, savedImpressionId);
			if (creat == null)
				return;

			if (typeof (creat.capSpecification) != 'undefined') {
				document.getElementById('native-cap-spec').value = creat.capSpecification;
				document.getElementById('native-cap-limit').value = creat.capFrequency;
				document.getElementById('native-cap-timeout').value = creat.capTimeout;
			}

			if (campaign.isAdx && creat.adxCreativeExtensions) {
				if (creat.adxCreativeExtensions.adxTrackingUrl)
					document.getElementById('native-adxtrackingurl').value = creat.adxCreativeExtensions.adxTrackingUrl;
				if (creat.adxCreativeExtensions.adxClickThroughUrl)
					document.getElementById('native-clickthroughurl').value = creat.adxCreativeExtensions.adxClickThroughUrl;
				if (creat.adxCreativeExtensions.adxCategory)
					document.getElementById('native-category').value = creat.adxCreativeExtensions.adxCategory;
				if (creat.adxCreativeExtensions.adxVendorType)
					document.getElementById('native-vendor-type').value = creat.adxCreativeExtensions.adxVendorType;
				if (creat.adxCreativeExtensions.attributes)
					setMultiSelect('native-adx-attrs',
							creat.adxCreativeExtensions.attributes);
			}
			
			document.getElementById('native-public-price').value = creat.price;
			initializeDeals(creat,'native');

			document.getElementById('native-url').value = creat.nativead.link.url;
			document.getElementById('native-fallbackurl').value = creat.nativead.link.fallback;
			clickDyno.clear();
			for (var i = 0; i < creat.nativead.link.clicktrackers.length; i++) {
				clickDyno.add([ creat.nativead.link.clicktrackers[i] ]);
			}
			impressionDyno.clear();
			for (var i = 0; i < creat.nativead.imptrackers.length; i++) {
				impressionDyno.add([ creat.nativead.imptrackers[i] ]);
			}
			assetsDyno.clear();
			for (var i = 0; i < creat.nativead.assets.length; i++) {
				p = creat.nativead.assets[i];
				if (typeof p.title != 'undefined') {
					document.getElementById('native-ad-title').value = p.title.text;
					if (typeof p.link != 'undefined') {
						document.getElementById('native-ad-title-cta').value = p.link.url;
					}
				}
				if (typeof p.img != 'undefined') {
					document.getElementById('native-ad-image-url').value = p.img.url;
					document.getElementById('native-ad-image-w').value = p.img.w;
					document.getElementById('native-ad-image-h').value = p.img.h;
					if (typeof p.link != 'undefined') {
						document.getElementById('native-ad-image-cta').value = p.link.url;
					}
				}
				if (typeof p.video != 'undefined') {
					document.getElementById('native-image-duration').value = p.video.duration;
					document.getElementById('native-image-protocol').value = p.video.protocol;
					document.getElementById('native-image-linearity').value = p.video.linearity;
					document.getElementById('native-image-xml').value = p.video.value;
				}
				if (typeof p.data != 'undefined') {
					var type = p.data.type;
					var text = p.data.value;
					var coa = '';
					if (typeof p.link != 'undefined') {
						coa = p.link.url;
					}
					var label = assetDataTypes[type];
					assetsDyno.add([ label, text, coa ]);
				}
			}
			
			nativeSpecialDyno.clear();
			if (creat.extensions) {
				for (key in creat.extensions ) {
					value = creat.extensions[key];
					nativeSpecialDyno.add([ key, value, "" ]);
				}
			}
			
			$('#nativeModal').modal('show');
		}
		function closeNativeModal() {

			campaign = getCampaign(currentCampaign);
			creat = getCreative(campaign, savedImpressionId);

			creat.price = Number(document.getElementById('native-public-price').value);
			creat.deals = getDeals('native');
			creat.extensions = getExtension('native');
			
			processCaps(creat, 'native');
			if (campaign.isAdx)
				processNativeAdx(creat)

				/*
				 * Link
				 */
			creat.link = {};
			creat.link.url = document.getElementById('native-url').value;
			creat.link.fallback = document.getElementById('native-fallbackurl').value;
			table = document.getElementById("addclicktrackers");
			creat.link.clicktrackers = [];
			rows = table.rows;
			for (var i = 3; i < rows.length; i++) {
				row = rows[i];
				cell = row.cells[0];
				text = cell.children[0].value;
				creat.link.clicktrackers.push(text);
			}
			/*
			 * Impression trackers
			 */
			table = document.getElementById("addimpressiontrackers");
			creat.imptrackers = [];
			rows = table.rows;
			for (var i = 3; i < rows.length; i++) {
				row = rows[i];
				cell = row.cells[0];
				text = cell.children[0].value;
				creat.imptrackers.push(text);
			}
			creat.assets = [];
			var cta;
			/**
			 * Title asset 
			 */
			title = document.getElementById('native-ad-title').value;
			if (title != '') {
				asset = {};
				entity = {};
				entity.text = title;
				asset.title = entity;
				cta = document.getElementById("native-ad-title-cta").value;
				if (cta != '') {
					asset.link = {};
					asset.link.url = cta;
				}
				creat.assets.push(asset);
			}
			/**
			 * Image asset
			 */
			image = document.getElementById("native-ad-image-url").value;
			if (value != '') {
				w = document.getElementById("native-ad-image-w").value;
				h = document.getElementById("native-ad-image-h").value;
				asset = {};
				entity = {};
				entity.url = image;
				entity.h = h;
				entity.w = w;
				asset.img = entity;
				cta = document.getElementById("native-ad-image-cta").value;
				if (cta != '') {
					asset.link = {};
					asset.link.url = cta;
				}
				creat.assets.push(asset);
				
			}
			/**
			 * Video is TBD
			 */
			////////////////////////
			/*
			 * The data objects 
			 */
			table = document.getElementById("addassets");
			rows = table.rows;
			for (var i = 2; i < rows.length; i++) {
				row = rows[i];
				cell = row.cells[0];
				type = cell.children[0].value;
				cell = row.cells[1];
				value = cell.children[0].value
				asset = {};
				entity = {};
				cell = row.cells[2];
				cta = cell.children[0].value
				if (cta != '') {
					asset.link = {};
					asset.link.url = cta;
				}
				index = 0;
				for (var j = 0; j < assetDataTypes.length; j++) {
					str = assetDataTypes[j];
					if (str === type) {
						index = j;
						break;
					}
				}
				entity.type = index;
				entity.value = value;
				asset.data = entity;
				creat.assets.push(asset);
			}
			assetsDyno.clear();
		};

		function setMultiSelect(name, values) {
			for (var i = 0; i < values.length; i++) {
				var e = values[i];
				$("#" + name + " option[value='" + e + "']").prop("selected",
						true);
			}
		}

		function runBannerModal(id) {

			var row = document.getElementById(id);
			var editorCell = row.cells[1];
			var a = editorCell.children[0].value;
			var campaign = getCampaign(currentCampaign);

			for (var i = 0; i < campaign.creatives.length; i++) {
				var c = campaign.creatives[i];

				if (c.impid == a) {
					if (typeof (c.capSpecification) != 'undefined') {
						document.getElementById('banner-cap-spec').value = c.capSpecification;
						document.getElementById('banner-cap-limit').value = c.capFrequency;
						document.getElementById('banner-cap-timeout').value = c.capTimeout;
					}

					if (campaign.isAdx && c.adxCreativeExtensions) {
						if (c.adxCreativeExtensions.adxTrackingUrl)
							document.getElementById('adxtrackingurl').value = c.adxCreativeExtensions.adxTrackingUrl;
						if (c.adxCreativeExtensions.adxClickThroughUrl)
							document.getElementById('clickthroughurl').value = c.adxCreativeExtensions.adxClickThroughUrl;
						if (c.adxCreativeExtensions.adxCategory)
							document.getElementById('banner-category').value = c.adxCreativeExtensions.adxCategory;
						if (c.adxCreativeExtensions.adxVendorType)
							document.getElementById('banner-vendor-type').value = c.adxCreativeExtensions.adxVendorType;
						if (c.adxCreativeExtensions.attributes)
							setMultiSelect('banner-adx-attrs',
									c.adxCreativeExtensions.attributes);
					}

					document.getElementById('banner-public-price').value = c.price;
					initializeDeals(c,'banner')

					crdyno.clear();
					for (var j = 0; j < c.attributes.length; j++) {
						var attribute = c.attributes[j];
						left = makeDottedAttribute(attribute);
						var op = attribute.op;
						var right = JSON.stringify(attribute.value);
						var req = !attribute.notPresentOk
						crdyno.add([ left, op, right, req, "" ]);
					}
					savedImpressionId = c.impid; // make sure the editor knows which impression is edited

					document.getElementById('bannerForwardUrl').value = c.forwardurl;
					document.getElementById('bannerImageUrl').value = c.imageurl;

					document.getElementById('bannerTitle').innerHTML = "<h2 class='modal-title'>Banner Constraint Editor: <i>"
							+ c.impid + "</i></h2>";

					bannerSpecialDyno.clear();
					if (c.extensions) {
						for (key in c.extensions ) {
							value = c.extensions[key];
							bannerSpecialDyno.add([ key, value, "" ]);
						}
					}
							
					$('#bannerModal').modal('show');
					return;
				}
			}
		}

		function showCampaign() {
			var campaign = getCampaign(currentCampaign);
			var str = JSON.stringify(campaign, null, 2);
			document.getElementById('campaignContents').innerHTML = str;
			$('#jsonDisplay').modal('show');

		}

		function runModal(id) {
			row = document.getElementById(id);
			videoEditorCell = cell = row.cells[1];
			a = cell.children[0].value;
			var campaign = getCampaign(currentCampaign);
			for (var i = 0; i < campaign.creatives.length; i++) {
				var c = campaign.creatives[i];
				if (c.impid == a) {

					if (typeof (c.capSpecification) != 'undefined') {
						document.getElementById('video-cap-spec').value = c.capSpecification;
						document.getElementById('video-cap-limit').value = c.capFrequency;
						document.getElementById('video-cap-timeout').value = c.capTimeout;
					}

					if (campaign.isAdx && c.adxCreativeExtensions) {
						if (c.adxCreativeExtensions.adxClickThroughUrl)
							document.getElementById('video-clickthroughurl').value = c.adxCreativeExtensions.adxClickThroughUrl;
						if (c.adxCreativeExtensions.adxCategory)
							document.getElementById('video-category').value = c.adxCreativeExtensions.adxCategory;
						if (c.adxCreativeExtensions.adxVendorType)
							document.getElementById('video-vendor-type').value = c.adxCreativeExtensions.adxVendorType;
						if (c.adxCreativeExtensions.attributes)
							setMultiSelect('video-adx-attrs',
									c.adxCreativeExtensions.attributes);
					}
					
					document.getElementById('video-public-price').value = c.price;

					videoCreative = c;
					initializeDeals(c,'video');

					if (typeof c.videoProtocol != 'undefined') {
						
						var proto = document.getElementById('video-protocol')
						var opt = proto.options[proto.selectedIndex];
						
						if (!opt) {
							opt = proto.options[1]
							opt.selected = true;
						}
						else {
							var value = c.videoProtocol.toString()
							for (var i = 0; i < proto.length; i++)  {
								opt = proto.options[i]
						    	if (opt.value == value)
						    		opt.selected = true;
						    	else
						    		opt.selected = false;
							}
						}
						
					}
					if (c.videoLinearity)
						document.getElementById('video-linearity').value = c.videoLinearity;
					
					if (typeof c.videoMimeType != 'undefined') {
						var mime = document.getElementById('video-mime')
						var opt = mime.options[mime.selectedIndex];
						
						if (!opt) {
							opt = mime.options[0]
							opt.selected = true
						} 
						else {
							for (var i = 0; i < mime.length; i++)  {
								opt = mime.options[i]
						    	if (opt.value == c.videoMimeType) 
						    		opt.selected = true;
						    	else
						    		opt.selected = false;
							}
						}
					}
					if (c.videoDuration)
						document.getElementById('video-duration').value = c.videoDuration;
					else
						document.getElementById('video-duration').value = "30";

					var str = "";
					for (var j = 0; j < c.adm.length; j++) {
						str += c.adm[j] + "\n";
					}
					document.getElementById('rawVideo').value = str;
					vdyno.clear();
					for (var j = 0; j < c.attributes.length; j++) {
						var attribute = c.attributes[j];
						left = makeDottedAttribute(attribute);
						var op = attribute.op;
						var right = JSON.stringify(attribute.value);
						var req = !attribute.notPresentOk;
						vdyno.add([ left, op, right, req, "" ]);
					}
								
					videoSpecialDyno.clear();
					if (c.extensions) {
						for (key in c.extensions ) {
							value = c.extensions[key];
							videoSpecialDyno.add([ key, value, "" ]);
						}
					}
						
					savedImpressionId = c.impid; // make sure the editor knows which impression is edited
					$('#videoModal').modal('show');
					return;
				}
			}
		}

		function processCaps(create, what) {
			if (document.getElementById(what + '-cap-spec').value == '') {
				create.capSpecification = '';
				create.capFrequency = '';
				create.capTimeout = '';
				return;
			}
			create.capSpecification = document.getElementById(what
					+ '-cap-spec').value;
			create.capFrequency = document.getElementById(what + '-cap-limit').value;
			create.capTimeout = document.getElementById(what + '-cap-timeout').value;
		}

		function processBannerAdx(create) {
			create.adxCreativeExtensions = {}
			if (campaign.isAdx) {
				if (document.getElementById('clickthroughurl').value != '')
					create.adxCreativeExtensions.adxClickThroughUrl = document
							.getElementById('clickthroughurl').value
				if (document.getElementById('adxtrackingurl').value != '')
					create.adxCreativeExtensions.adxTrackingUrl = document
							.getElementById('adxtrackingurl').value
				if (document.getElementById('banner-category').value != "")
					create.adxCreativeExtensions.adxCategory = document
							.getElementById('banner-category').value
				if (document.getElementById('banner-vendor-type').value != "")
					create.adxCreativeExtensions.adxVendorType = document
							.getElementById('banner-vendor-type').value
				if (document.getElementById('banner-adx-attrs').value != '')
					create.adxCreativeExtensions.attributes = processNumberedAttributes('banner-adx-attrs')
			}
		}

		function processVideoAdx(create) {
			create.adxCreativeExtensions = {}
			if (campaign.isAdx) {
				if (document.getElementById('video-clickthroughurl').value != "")
					create.adxCreativeExtensions.adxClickThroughUrl = document
							.getElementById('video-clickthroughurl').value
				if (document.getElementById('video-category').value != "")
					create.adxCreativeExtensions.adxCategory = document
							.getElementById('video-category').value
				if (document.getElementById('video-vendor-type').value != "")
					create.adxCreativeExtensions.adxVendorType = document
							.getElementById('video-vendor-type').value
				if (document.getElementById('video-adx-attrs').value != '')
					create.adxCreativeExtensions.attributes = processNumberedAttributes('video-adx-attrs');
			}
		}

		function processNativeAdx(create) {
			create.adxCreativeExtensions = {}
			if (campaign.isAdx) {
				if (document.getElementById('native-clickthroughurl').value != "")
					create.adxCreativeExtensions.adxClickThroughUrl = document
							.getElementById('native-clickthroughurl').value
				if (document.getElementById('native-category').value != "")
					create.adxCreativeExtensions.adxCategory = document
							.getElementById('native-category').value
				if (document.getElementById('native-vendor-type').value != "")
					create.adxCreativeExtensions.adxVendorType = document
							.getElementById('native-vendor-type').value
				if (document.getElementById('video-adx-attrs').value != '')
					create.adxCreativeExtensions.attributes = processNumberedAttributes('native-adx-attrs');
			}
		}

		function closeVideModal() {
			campaign = getCampaign(currentCampaign);
			creat = getCreative(campaign, savedImpressionId);
			creat.attributes = makeAttributes("addvideoconstraints");
			creat.adm = document.getElementById('rawVideo').value.split('\n');
			creat.price = document.getElementById('video-public-price').value;
			
			creat.videoDuration = Number(document.getElementById('video-duration').value);
			creat.videoLinearity = Number(document.getElementById('video-linearity').value);
			
			var proto_opt = document.getElementById('video-protocol');	
			var mime = document.getElementById('video-mime');
		    var opt = mime.options[mime.selectedIndex];
			creat.videoMimeType = opt.value;
			opt = proto_opt.options[proto_opt.selectedIndex];
			creat.videoProtocol = Number(opt.value);
			
			creat.extensions = getExtension('video');
			creat.deals = getDeals('video')
			processCaps(creat, 'video');
			if (campaign.isAdx)
				processVideoAdx(creat)
		}
		
		function closeBannerModal() {
			campaign = getCampaign(currentCampaign);
			creat = getCreative(campaign, savedImpressionId);
			creat.attributes = makeAttributes("addbannerconstraints");
			creat.forwardurl = document.getElementById('bannerForwardUrl').value;
			creat.imageurl = document.getElementById('bannerImageUrl').value;
			creat.price = document.getElementById('banner-public-price').value;
			creat.deals = getDeals('banner')
			creat.extensions = getExtension('banner');
			processCaps(creat, 'banner');
			if (campaign.isAdx)
				processBannerAdx(creat)
		}
		

		function processNumberedAttributes(tableName) {
			var attributes = [];
			var name = 'select#' + tableName
			var list = $(name).val()
			for (var i = 0; i < list.length; i++) {
				var v = list[i];
				v = Number(v)
				attributes.push(v);
			}
			return attributes;
		}

		/* Make dotted attribute name from attrinute name array */
		function makeDottedAttribute(attribute) {
			var left = "";
			for (var k = 0; k < attribute.bidRequestValues.length; k++) {
				left += attribute.bidRequestValues[k];
				if (k + 1 < attribute.bidRequestValues.length)
					left += ".";
			}
			return left;
		}
		camps = [];
		cells = [];
		cells
				.push("<input type='text' readonly id='SUB_ID' value='SUB_VALUE'>");
		cells
				.push("<input type='button' onclick='processCampaign(\"SUB_ID\")' value='SUB_VALUE' id='SUB_ID' class='primary-btn col-xs-11 text-left' style=\"width:280px\">");
		cells
				.push("<a href=\"javascript:deleteCampaign('ROW_ID','SUB_ID');\">Del<\/a>");
		dyno = new DynamicTable("addinput", cells);
		zcells = [];
		zcells.push('SUB_VALUE')
		zcells
				.push("<input type='button' onclick='startStop(\"ROW_ID\")' value='Start' id='ROW_ID' class='primary-btn col-xs-11 text-left' style=\"width:100px\"/>");
		campStatus = new DynamicTable("addstatus", zcells);
		////////////////////////////////////
		images = [];
		imageCells = [];
		imageCells.push("<img src='SUB_VALUE' id='SUB_ID'/>");
		imageCells.push("SUB_VALUE");
		//    imageCells.push("<input type='button' class='btn btn-default' value='-' onclick='deleteRow(\"SUB_ID\", \"SUB_VALUE\"><\/button>");

		imageCells
				.push("<a href=\"javascript:deleteImageRow('ROW_ID');\">Del<\/a>");
		imagesTable = new DynamicTable("addimages", imageCells);
		//////////////////////////////
		var nativeAdTypes = [ '', 'Content Wall', 'App Wall', 'News Feed',
				'Chat List', 'Carousel', 'Content Stream', 'Grid Adjoining' ];
		function getNativeAdType(test) {
			for (var i = 0; i < nativeAdTypes.length; i++) {
				if (test === nativeAdTypes[i])
					return i;
			}
			return 0;
		}
		var assetDataTypes = [ '', 'Sponsored', 'Descriptive text', 'Rating',
				'Likes', 'Downloads', 'Price', 'Sale Price', 'Phone',
				'Address', 'Additional description',
				'Display URL for the text ad', 'Call To Action Text' ];
		function testCreative(type, id) {
			var camp = getCampaign(currentCampaign);
			var name = camp.owner;
			var campId = camp.adId;
			var impId;
			var parts = id.split(":");
			var row = Number(parts[2]);
			if (type === 'BANNER') {
				var obj = creativeDyno.getObject(row - 1, 3);
				impId = obj.value;
			} else if (type === 'VIDEO') {
				var obj = videoCreativeDyno.getObject(row - 1, 1);
				impId = obj.value;
			} else {
				var obj = natDyno.getObject(row - 1, 1);
				impId = obj.value;
			}
			var msg = {
				command : 'showCreative',
				name : name,
				adid : campId,
				impid : impId
			};
			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(msg),
				dataType : 'json',
				success : function(data, textStatus, request) {
					text = request.responseText;
					if (request.status == 204) {
						text = "";
					} else {
						data = JSON.parse(text);

						//////// The creative will work here!
						window.open(data.creative, "Test me");

					}
				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"HTTP Session closed");
				}
			});
		}
		
		function initializeDeals(c,type) {
			var deals = c.deals
			var dyno 
			if (type === 'banner') {
				dyno = bannerDealDyno;
			}
			if (type === 'video') {
				dyno = videoDealDyno;
			}
			if (type === 'native') {
				dyno = nativeDealDyno;
			}
			dyno.clear();
			if (!deals)
				return
				
			for (var i = 0; i < deals.length; i++) {
				var deal = deals[i]
				dyno.add([deal.id,deal.price,''])
			}
		}
		
		function getDeals(type) {
			var deals = []
			var table 
			if (type === 'banner') {
				table = document.getElementById("bannerDeal");
			}
			if (type === 'video') {
				table = document.getElementById("videoDeal");
			}
			if (type === 'native') {
				table = document.getElementById("nativeDeal");
			}
			var rows = table.rows;
			for (var i = 2; i < rows.length; i++) {
				var a = rows[i].cells[0].children[0].value;
				var b = rows[i].cells[1].children[0].value;
				var deal = {}
				deal.id = a
				deal.price = Number(b)
				deals.push(deal)
			}
			
			return deals
		}
		
		function getExtension(type) {
			var table 
			if (type === 'banner') {
				table = document.getElementById("bannerSpecialAttributes");
			}
			if (type === 'video') {
				table = document.getElementById("videoSpecialAttributes");
			}
			if (type === 'native') {
				table = document.getElementById("nativeSpecialAttributes");
			}
			var rows = table.rows;
			if (rows.length <= 2)
				return null;
			
			var extension = {};
			for (var i = 2; i < rows.length; i++) {
				var a = rows[i].cells[0].children[0].value;
				var b = rows[i].cells[1].children[0].value;
				extension[a] = b
			}
			
			return extension;
		}
		
		function addDeal(element) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			var id = document.getElementById("p_new_deal_id_"+element);
			var price = document.getElementById("p_new_deal_price_"+element);
			var pid = id.value;
			var pprice = price.value;
			if (element === 'bannerDeal')
				bannerDealDyno.add([pid,pprice,''])
			if (element === 'nativeDeal')
				nativeDealDyno.add([pid,pprice,''])
			if (element === 'videoDeal')
				videoDealDyno.add([pid,pprice,''])
			id.value = ''
			price.value = ''

		}
		
		function addSpecialAttributes(element) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			var tkey = document.getElementById("p_new_attribute_key_"+element);
			var tval = document.getElementById("p_new_attribute_value_"+element);
			var key = tkey.value;
			var val = tval.value;
			if (element === 'bannerSpecialAttributes')
				bannerSpecialDyno.add([key,val,''])
			if (element === 'nativeSpecialAttributes')
				nativeSpecialDyno.add([key,val,''])
			if (element === 'videoSpecialAttributes')
				videoSpecialDyno.add([key,val,''])
			tkey.value = ''
			tval.value = ''

		}
		
		function deleteDeal(what, element) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			x = document.getElementById(what);
			console.log("val = " + x.value);
			if (element === 'bannerDeal') {
				bannerDealDyno.remove(what);
			}
			if (element === 'nativeDeal') {
				nativeDealDyno.remove(what);
			}
			if (element === 'videoDeal') {
				videoDealDyno.remove(what);
			}
		}
		
		function deleteSpecialAttr(what, element) {
			if (document.getElementById("username").value === 'demo') {
				doModal(BootstrapDialog.TYPE_ERROR, "Error",
						"Demo login can't perform this command.");
				return
			}
			x = document.getElementById(what);
			console.log("val = " + x.value);
			if (element === 'banner') {
				bannerSpecialDyno.remove(what);
			}
			if (element === 'native') {
				nativeSpecialDyno.remove(what);
			}
			if (element === 'video') {
				videoSpecialDyno.remove(what);
			}
		}
		
		
		pCells = []
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Prive/preferred ID' />");
		pCells.push("<input type='text' id='SUB_ID' size='8' value='' placeholder='Price' />");
		pCells.push("<a href=\"javascript:deleteDeal('ROW_ID','bannerDeal');\">Del<\/a><\/td>");
		bannerDealDyno = new DynamicTable("bannerDeal", pCells);
		pCells = []
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Prive/preferred ID' />");
		pCells.push("<input type='text' id='SUB_ID' size='8' value='' placeholder='Price' />");
		pCells.push("<a href=\"javascript:deleteDeal('ROW_ID','nativeDeal');\">Del<\/a><\/td>");
		nativeDealDyno = new DynamicTable("nativeDeal", pCells);
		pCells = []
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Prive/preferred ID' />");
		pCells.push("<input type='text' id='SUB_ID' size='8' value='' placeholder='Price' />");
		pCells.push("<a href=\"javascript:deleteDeal('ROW_ID','videoDeal');\">Del<\/a><\/td>");
		videoDealDyno = new DynamicTable("videoDeal", pCells); 
		
		///////////////////
		
		pCells = []
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Key' />");
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Value' />");
		pCells.push("<a href=\"javascript:deleteSpecialAttr('ROW_ID','banner');\">Del<\/a><\/td>");
		bannerSpecialDyno = new DynamicTable("bannerSpecialAttributes", pCells);
		pCells = []
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Key' />");
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='value' />");
		pCells.push("<a href=\"javascript:deleteSpecialAttr('ROW_ID','native');\">Del<\/a><\/td>");
		nativeSpecialDyno = new DynamicTable("nativeSpecialAttributes", pCells);
		pCells = []
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Key' />");
		pCells.push("<input type='text' id='SUB_ID' size='32' value='' placeholder='Value' />");
		pCells.push("<a href=\"javascript:deleteSpecialAttr('ROW_ID','video');\">Del<\/a><\/td>");
		videoSpecialDyno = new DynamicTable("videoSpecialAttributes", pCells); 
		
		
		crCells = []
		crCells
				.push("<a href='javascript:testCreative(\"BANNER\",\"SUB_ID\")'><span class='glyphicon glyphicon-heart'><\/span><\/a>");
		crCells
				.push("<input type='text' disabled id='SUB_ID' size='20' value='' placeholder='Impression ID' />");
		crCells.push("<input type='checkbox' id='SUB_ID'>");
		crCells
				.push("<input type='text' id='SUB_ID' size='6' value='' placeholder='width' />");
		crCells
				.push("<input type='text' id='SUB_ID' size='6' value='' placeholder='height' />");
		crCells
				.push("<button type='button' class='btn btn-info btn-sm' data-toggle='modal' onclick=\"runBannerModal('ROW_ID');\">Editor<\/button>");
		crCells
				.push("<a href=\"javascript:deleteCreative('ROW_ID');\">Del<\/a><\/td>");
		creativeDyno = new DynamicTable("addcreative", crCells);
		///////////// Video creative ////////////////////
		vcrCells = []
		vcrCells
				.push("<a href='javascript:testCreative(\"VIDEO\",\"SUB_ID\")'><span class='glyphicon glyphicon-heart'><\/span><\/a>");
		vcrCells
				.push("<input type='text' disabled id='SUB_ID' size='20' value='' placeholder='Impression ID' />");
		vcrCells
				.push("<input type='text' id='SUB_ID' size='6' value='' placeholder='width' />");
		vcrCells
				.push("<input type='text' id='SUB_ID' size='6' value='' placeholder='height' />");
		vcrCells
				.push("<button type='button' class='btn btn-info btn-sm' data-toggle='modal' onclick=\"runModal('ROW_ID');\">Tags<\/button>");
		vcrCells
				.push("<a href=\"javascript:deleteVideoCreative('ROW_ID');\">Del<\/a><\/td>");
		videoCreativeDyno = new DynamicTable("addvideocreative", vcrCells);
		/////////////// Native click tracker //////////////////
		clickCells = [];
		clickCells
				.push("<input type='text' id='SUB_ID' size='50' value='' placeholder='Click Tracking URL' />");
		clickCells
				.push("<a href=\"javascript:deleteNativeClickTracking('ROW_ID');\">Del<\/a><\/td>");
		clickDyno = new DynamicTable("addclicktrackers", clickCells);
		impressionCells = [];
		impressionCells
				.push("<input type='text' id='SUB_ID' size='50' value='' placeholder='Impression Tracking URL' />");
		impressionCells
				.push("<a href=\"javascript:deleteNativeImpressionTracking('ROW_ID');\">Del<\/a><\/td>");
		impressionDyno = new DynamicTable("addimpressiontrackers",
				impressionCells);
		/////////// Native Creative //////////////////////////
		natCells = []
		natCells
				.push("<a href='javascript:testCreative(\"NATIVE\",\"SUB_ID\")'><span class='glyphicon glyphicon-heart'><\/span><\/a>");
		natCells
				.push("<input disabled type='text' id='SUB_ID' size='20' value='' placeholder='Impression ID' />");
		natCells.push("<select class='form-control' id='SUB_ID'>"
				+ "<option value='Content Wall'>Content Wall<\/option>"
				+ "<option value='App Wall' selected>App Wall<\/option>"
				+ "<option value='News Feed'>News Feed<\/option>"
				+ "<option value='Chat List'>Chat List<\/option>"
				+ "<option value='Carousel'>Carousel<\/option>"
				+ "<option value='Content Stream'>Content Stream<\/option>"
				+ "<option value='Grid Adjoining<\/option>" + "<\/select>")
		natCells
				.push("<button type='button' class='btn btn-info btn-sm' data-toggle='modal' onclick=\"runNativeModal('ROW_ID');\">Editor<\/button>");
		natCells
				.push("<a href=\"javascript:deleteNativeCreative('ROW_ID');\">Del<\/a><\/td>");
		natDyno = new DynamicTable("addnative", natCells);
		///////////////////// Native data assets /////////////////
		assetCells = [];
		assetCells
				.push("<select class='selectpicker' id='SUB_ID'>"
						+ "<option value='Sponsored'>Sponsored<\/option>"
						+ "<option value='Descriptive text'>Descriptive text<\/option>"
						+ "<option value='Rating'>Rating<\/option>"
						+ "<option value='Likes'>Likes<\/option>"
						+ "<option value='Downloads'>Downloads<\/option>"
						+ "<option value='Price'>Price<\/option>"
						+ "<option value='Sale Price'>Sale price<\/option>"
						+ "<option value='Phone'>Phone<\/option>"
						+ "<option value='Address'>Address<\/option>"
						+ "<option value='Additional descrption'>Additional description<\/option>"
						+ "<option value='Display URL for the text ad'>Display URL for the text ad<\/option>"
						+ "<option value='Call To Action Text'>Call To Action Text<\/option>"
						+ "<\/select>");
		assetCells
				.push("<input type='text' id='SUB_ID' size='30'value='' placeholder='Data value' />");
		assetCells
				.push("<input type='text' id='SUB_ID' size='30'value='' placeholder='Call to action value' />");
		assetCells
				.push("<a href=\"javascript:deleteAssetsRow('ROW_ID');\">Del<\/a><\/td>");
		assetsDyno = new DynamicTable("addassets", assetCells);
		operator_defs = "<option value='EQUALS'>EQUALS<\/option>"
				+ "<option value='NOT_EQUALS'>NOT_EQUALS<\/option>"
				+ "<option value='MEMBER'>MEMBER<\/option>"
				+ "<option value='NOT_MEMBER'>NOT_MEMBER<\/option>"
				+ "<option value='INTERSECTS'>INTERSECTS<\/option>"
				+ "<option value='NOT_INTERSECTS'>NOT_INTERSECTS<\/option>"
				+ "<option value='INRANGE'>INRANGE<\/option>"
				+ "<option value='NOT_INRANGE'>NOT_INRANGE<\/option>"
				+ "<option value='LESS_THAN'>LESS_THAN<\/option>"
				+ "<option value='LESS_THAN_EQUALS'>LESS_THAN_EQUALS<\/option>"
				+ "<option value='GREATER_THAN'>GREATER_THAN<\/option>"
				+ "<option value='GREATER_THAN_EQUALS'>GREATER_THAN_EQUALS<\/option>"
				+ "<option value='DOMAIN'>DOMAIN<\/option>"
				+ "<option value='NOT_DOMAIN'>NOT_DOMAIN<\/option>"
				+ "<option value='STRINGIN'>STRINGIN<\/option>"
				+ "<option value='NOT_STRINGIN'>STRINGIN<\/option>"
				+ "<option value='EXISTS'>EXISTS<\/option>"
				+ "<option value='NOT_EXISTS'>NOT_EXISTS<\/option>"
				+ "<option value='REGEX'>REGEX<\/option>"
				+ "<option value='NOT_REGEX'>NOT_REGEX<\/option>";

		//////////////////////////////////////////////////////////////////
		////////////// VIDEO attributes ////////////////////////
		crcells = [];
		crcells
				.push("<input type='text' id='SUB_ID' size='30'value='' placeholder='constraint name' />")
		crcells.push("<select class='form-control' id='SUB_ID'>"
				+ operator_defs + "<\/select>")
		crcells
				.push("<input type='text' id='SUB_ID' size='40'value='' placeholder='constraint value' />")
		crcells
				.push("<input type='checkbox' id='SUB_ID'>")
		crcells
				.push("<a href=\"javascript:deleteVideoConstraintRow('ROW_ID');\">Del<\/a><\/td>");
		crdyno = new DynamicTable("addbannerconstraints", crcells);
		////////////// VIDEO attributes ////////////////////////
		vcells = [];
		vcells
				.push("<input type='text' id='SUB_ID' size='30'value='' placeholder='constraint name' />")
		vcells.push("<select class='form-control' id='SUB_ID'>" + operator_defs
				+ "<\/select>")
		vcells
				.push("<input type='text' id='SUB_ID' size='40'value='' placeholder='constraint value' />")
		vcells
				.push("<input type='checkbox' id='SUB_ID'>")
		vcells
				.push("<a href=\"javascript:deleteVideoConstraintRow('ROW_ID');\">Del<\/a><\/td>");
		vdyno = new DynamicTable("addvideoconstraints", vcells);
		function disableTabs(mode) {
			disabler(document.getElementById("myTabContent"), mode);
		}
		function disabler(el, mode) {
			try {
				el.disabled = mode
			} catch (E) {
			}
			if (el.childNodes && el.childNodes.length > 0) {
				for (var x = 0; x < el.childNodes.length; x++) {
					if (el.childNodes[x].id != 'zstatus'
							&& el.childNodes[x].id != 'images')
						disabler(el.childNodes[x], mode);
				}
			}
		}
		/** Format or minimize xml */
		function doFormatXML(squeeze) {
			var text = document.getElementById("rawVideo").value;
			if (!squeeze)
				text = vkbeautify.xml(text);
			else
				text = vkbeautify.xmlmin(text);
			document.getElementById("rawVideo").value = text;
		}
		function doDemo() {
			document.getElementById('addCampaignButton').setAttribute(
					'disabled', true);
			document.getElementById('saveChanges').setAttribute('disabled',
					true);
			document.getElementById('uploadFile')
					.setAttribute('disabled', true);
		}

		if (typeof (rtb4free_demo) != 'undefined') {
			$('#username').val("demo");
			doModal(
					BootstrapDialog.TYPE_INFO,
					"Info",
					"You are logging in as 'demo', just press 'Sign In' to go to\nproceed to the campaign admin page");
		}

		function updateUser() {
			var pass = $('#p_user_pass').val();
			var phone = $('#p_user_phone').val();
			var email = $('#p_user_email').val();
			var credit = $('#p_user_credit').val();

			msg = {};
			msg.command = 'updateUser';
			msg.name = username.value;
			msg.pass = pass;
			msg.phone = phone;
			msg.email = email;
			msg.credit = credit;

			$.ajax({
				type : 'POST',
				url : 'ajax',
				data : JSON.stringify(msg),
				dataType : 'json',
				success : function(data, textStatus, request) {
					if (request.status == 204) {
						text = "";
					} else {
						text = request.responseText;
						data = JSON.parse(text);
						message = data.message;
					}
					if (data.error === true)
						doModal(BootstrapDialog.TYPE_ERROR, "Error", message);
					else
						doModal(BootstrapDialog.TYPE_INFO, "Info", message);

				},
				error : function(request, textStatus, errorThrown) {
					doModal(BootstrapDialog.TYPE_ERROR, "HTTP Error",
							"Server error");
				}
			});
		}
		deletions = [];
	

		ccells = [];
		ccells
				.push("<input type='text' id='SUB_ID' size='30'value='' placeholder='constraint name' />")
		ccells.push("<select class='form-control' id='SUB_ID'>" + operator_defs
				+

				"<\/select>")
		ccells
				.push("<input type='text' id='SUB_ID' size='40'value='' placeholder='constraint value' />")
		ccells.push("<input type='checkbox' id='SUB_ID' checked>");
		ccells
				.push("<a href=\"javascript:deleteConstraintRow('ROW_ID');\">Del<\/a><\/td>");
		cdyno = new DynamicTable("addconstraints", ccells);
		
		
		function doSomething() {
			value = $('#p_new_constraint').val()
			if (value === '?')
				$('#objectHelper').modal('show');
		}
		
		rtbConstraints = 
			"<option>app</option>" 
		+	"<option>app.bundle</option>"
		+	"<option>app.cat</option>"
		+	"<option>app.domain</option>"
		+	"<option>app.id</option>"
		+	"<option>app.keywords</option>"
		+	"<option>app.name</option>"
		+	"<option>app.pagecat</option>"
		+	"<option>app.privacypolicy</option>"
		+	"<option>app.publisher</option>"
		+	"<option>app.publisher.cat</option>"
		+	"<option>app.publisher.domain</option>"
		+	"<option>app.publisher.id</option>"
		+	"<option>app.publisher.name</option>"
		+	"<option>app.sectioncat</option>"
		+	"<option>app.storeurl</option>"
		+	"<option>app.ver</option>"
		+	"<option>at</option>"
		+	"<option>badv</option>"
		+	"<option>bcat</option>"
		+	"<option>cur</option>"
		+	"<option>device>"
		+	"<option>device.carrier</option>"
		+	"<option>device.connectiontype</option>"
		+	"<option>device.devicetype</option>"
		+	"<option>device.didmd5</option>"
		+	"<option>device.didsha1</option>"
		+	"<option>device.dnt</option>"
		+	"<option>device.dpidmd5</option>"
		+	"<option>device.dpidsha1</option>"
		+ 	"<option>device.flashver</option>"
		+	"<option>device.geo.city</option>"
		+	"<option>device.geo</option>"
		+	"<option>device.geo.country</option>"
		+	"<option>device.geo.lat</option>"
		+	"<option>device.geo.lat</option>"
		+	"<option>device.geo.lon</option>"
		+	"<option>device.geo.lon</option>"
		+	"<option>device.geo.metro</option>"
		+	"<option>device.geo.region</option>"
		+	"<option>device.geo.regionfips104</option>"
		+	"<option>device.geo.type</option>"
		+	"<option>device.geo.utcoffset</option>"
		+	"<option>device.geo.zip</option>"
		+	"<option>device.ifa</option>"
		+	"<option>device.ip</option>"
		+	"<option>device.js</option>"
		+ 	"<option>device.language</option>"
		+ 	"<option>device.lmt</option>"
		+ 	"<option>device.macmd5</option>"
		+ 	"<option>device.macsha1</option>"
		+	"<option>device.make</option>"
		+	"<option>device.model</option>"
		+	"<option>device.os</option>"
		+	"<option>device.osv</option>"
		+ 	"<option>device.ppi</option>"
		+ 	"<option>device.pxratio</option>"
		+	"<option>device.ua</option>"
		+	"<option>exchange</option>"
		+	"<option>ext</option>"
		+	"<option>ext.partnerid</option>"
		+	"<option>id</option>"
		+	"<option>imp.0.banner</option>"
		+	"<option>imp.0.banner.api</option>"
		+	"<option>imp.0.banner.battr</option>"
		+	"<option>imp.0.banner.btype</option>"
		+	"<option>imp.0.banner.h</option>"
		+	"<option>imp.0.banner.expdir</option>"
		+	"<option>imp.0.banner.hmin</option>"
		+	"<option>imp.0.banner.mimes</option>"
		+	"<option>imp.0.banner.pos</option>"
		+	"<option>imp.0.banner.topframe</option>"
		+	"<option>imp.0.banner.w</option>"
		+	"<option>imp.0.banner.wmin</option>"
		+	"<option>imp.0.bidfloor</option>"
		+	"<option>imp.0.displaymanager</option>"
		+	"<option>imp.0.id</option>"
		+	"<option>imp.0.iframebuster</option>"
		+	"<option>imp.0.instl</option>"
		+	"<option>imp.0.native</option>"
		+	"<option>imp.0.native.api</option>"
		+	"<option>imp.0.native.ext</option>"
		+	"<option>imp.0.native.battr</option>"
		+	"<option>imp.0.native.request</option>"
		+	"<option>imp.0.native.ver</option>"
		+	"<option>imp.0.pmp</option>"
		+	"<option>imp.0.pmp.deals</option>"
		+	"<option>imp.0.pmp.private_auction</option>"
		+	"<option>imp.0.video</option>"
		+	"<option>imp.0.video.api</option>"
		+	"<option>imp.0.video.boxingallowed</option>"
		+	"<option>imp.0.video.companionad</option>"
		+	"<option>imp.0.video.delivery</option>"
		+	"<option>imp.0.video.ext</option>"
		+	"<option>imp.0.video.h</option>"
		+	"<option>imp.0.video.linearity</option>"
		+	"<option>imp.0.video.mimes</option>"
		+	"<option>imp.0.video.maxbitrate</option>"
		+	"<option>imp.0.video.maxduration</option>"
		+	"<option>imp.0.video.minbitrate</option>"
		+	"<option>imp.0.video.minduration</option>"
		+	"<option>imp.0.video.playbackmethod</option>"
		+	"<option>imp.0.video.pos</option>"
		+	"<option>imp.0.video.protocols</option>"
		+	"<option>imp.0.video.sequence</option>"
		+	"<option>imp.0.video.startdelay</option>"
		+	"<option>imp.0.video.w</option>"
		+	"<option>imp.0.secure</option>"
		+	"<option>rtb4free</option>"
		+	"<option>rtb4free.geocode</option>"
		+	"<option>rtb4free.geocode.city</option>"
		+	"<option>rtb4free.geocode.county</option>"
		+	"<option>rtb4free.geocode.state</option>"
		+	"<option>rtb4free.geocode.zipcode</option>"
		+	"<option>site</option>"
		+	"<option>site.cat</option>"
		+	"<option>site.content.id</option>"
		+	"<option>site.domain</option>"
		+	"<option>site.id</option>"
		+	"<option>site.keywords</option>"
		+	"<option>site.name</option>"
		+	"<option>site.page</option>"
		+	"<option>site.pagecat</option>"
		+	"<option>site.privacypolicy</option>"
		+	"<option>site.publisher</option>"
		+	"<option>site.publisher.cat</option>"
		+	"<option>site.publisher.domain</option>"
		+	"<option>site.publisher.id</option>"
		+	"<option>site.publisher.name</option>"
		+	"<option>site.ref</option>"
		+	"<option>tmax</option>"
		+	"<option>user</option>"
		+	"<option>user.buyerid</option>"
		+	"<option>user.customdata</option>"
		+	"<option>user.id</option>"
		+	"<option>user.data</option>"
		+	"<option>user.data.segment.coppa</option>"
		+	"<option>user.data.id</option>"
		+	"<option>user.data.name</option>"
		+	"<option>user.data.segment</option>"
		+	"<option>user.data.segment.id</option>"
		+	"<option>user.data.segment.name</option>"
		+	"<option>user.data.segment.value</option>"
		+	"<option>user.id</option>"
		+	"<option>user.keywords</option>"
		+	"<option>user.yob</option>"
		+	"<option>regs</option>"
		+	"<option>wseat</option>"
		
		adxConstraints = rtbConstraints	
		
	</script>
	
</body>
</html>
